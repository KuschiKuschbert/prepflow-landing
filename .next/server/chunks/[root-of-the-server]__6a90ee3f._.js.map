{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///Users/danielkuschmierz/prepflow-landing/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\n\n// Client-side Supabase client\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables. Please check your .env.local file.')\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\n\n// Server-side Supabase client with service role key (only available on server)\nexport function createSupabaseAdmin() {\n  const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n  if (!serviceRoleKey) {\n    throw new Error('Missing SUPABASE_SERVICE_ROLE_KEY environment variable.')\n  }\n\n  if (!supabaseUrl) {\n    throw new Error('Missing NEXT_PUBLIC_SUPABASE_URL environment variable.')\n  }\n\n  return createClient(supabaseUrl, serviceRoleKey)\n}\n\n// For backward compatibility, create admin client only on server-side\nexport const supabaseAdmin = typeof window === 'undefined' ? createSupabaseAdmin() : null\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,8BAA8B;AAC9B,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,yMAAY,EAAC,aAAa;AAG3C,SAAS;IACd,MAAM,iBAAiB,QAAQ,GAAG,CAAC,yBAAyB;IAE5D,IAAI,CAAC,gBAAgB;QACnB,MAAM,IAAI,MAAM;IAClB;IAEA;;IAIA,OAAO,IAAA,yMAAY,EAAC,aAAa;AACnC;AAGO,MAAM,gBAAgB,uCAAgC,wBAAwB","debugId":null}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///Users/danielkuschmierz/prepflow-landing/app/api/prep-lists/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { supabaseAdmin } from '@/lib/supabase';\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const userId = searchParams.get('userId');\n\n    if (!userId) {\n      return NextResponse.json({ \n        error: 'User ID is required',\n        message: 'Please provide a valid user ID'\n      }, { status: 400 });\n    }\n\n    if (!supabaseAdmin) {\n      return NextResponse.json({ \n        error: 'Database connection not available' \n      }, { status: 500 });\n    }\n\n    const { data, error } = await supabaseAdmin\n      .from('prep_lists')\n      .select(`\n        *,\n        kitchen_sections (\n          id,\n          name,\n          color\n        ),\n        prep_list_items (\n          id,\n          ingredient_id,\n          quantity,\n          unit,\n          notes,\n          ingredients (\n            id,\n            name,\n            unit,\n            category\n          )\n        )\n      `)\n      .eq('user_id', userId)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error fetching prep lists:', error);\n      return NextResponse.json({ \n        error: 'Failed to fetch prep lists',\n        message: 'Could not retrieve prep list data'\n      }, { status: 500 });\n    }\n\n    return NextResponse.json({ \n      success: true,\n      data: data || []\n    });\n\n  } catch (error) {\n    console.error('Prep lists API error:', error);\n    return NextResponse.json({ \n      error: 'Internal server error',\n      message: 'An unexpected error occurred'\n    }, { status: 500 });\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { userId, kitchenSectionId, name, notes, items } = body;\n\n    if (!userId || !kitchenSectionId || !name) {\n      return NextResponse.json({ \n        error: 'Missing required fields',\n        message: 'User ID, kitchen section ID, and name are required'\n      }, { status: 400 });\n    }\n\n    if (!supabaseAdmin) {\n      return NextResponse.json({ \n        error: 'Database connection not available' \n      }, { status: 500 });\n    }\n\n    // Create the prep list\n    const { data: prepList, error: prepError } = await supabaseAdmin\n      .from('prep_lists')\n      .insert({\n        user_id: userId,\n        kitchen_section_id: kitchenSectionId,\n        name: name,\n        notes: notes,\n        status: 'draft',\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString()\n      })\n      .select()\n      .single();\n\n    if (prepError) {\n      console.error('Error creating prep list:', prepError);\n      return NextResponse.json({ \n        error: 'Failed to create prep list',\n        message: 'Could not save prep list data'\n      }, { status: 500 });\n    }\n\n    // Add items if provided\n    if (items && items.length > 0) {\n      const prepItems = items.map((item: any) => ({\n        prep_list_id: prepList.id,\n        ingredient_id: item.ingredientId,\n        quantity: item.quantity,\n        unit: item.unit,\n        notes: item.notes\n      }));\n\n      const { error: itemsError } = await supabaseAdmin\n        .from('prep_list_items')\n        .insert(prepItems);\n\n      if (itemsError) {\n        console.error('Error creating prep list items:', itemsError);\n        // Don't fail the entire request, just log the error\n      }\n    }\n\n    return NextResponse.json({ \n      success: true,\n      message: 'Prep list created successfully',\n      data: prepList\n    });\n\n  } catch (error) {\n    console.error('Prep lists API error:', error);\n    return NextResponse.json({ \n      error: 'Internal server error',\n      message: 'An unexpected error occurred'\n    }, { status: 500 });\n  }\n}\n\nexport async function PUT(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { id, kitchenSectionId, name, notes, status, items } = body;\n\n    if (!id) {\n      return NextResponse.json({ \n        error: 'Missing required fields',\n        message: 'Prep list ID is required'\n      }, { status: 400 });\n    }\n\n    const updateData: any = {\n      updated_at: new Date().toISOString()\n    };\n\n    if (kitchenSectionId !== undefined) updateData.kitchen_section_id = kitchenSectionId;\n    if (name !== undefined) updateData.name = name;\n    if (notes !== undefined) updateData.notes = notes;\n    if (status !== undefined) updateData.status = status;\n\n    if (!supabaseAdmin) {\n      return NextResponse.json({ \n        error: 'Database connection not available' \n      }, { status: 500 });\n    }\n\n    const { data, error } = await supabaseAdmin\n      .from('prep_lists')\n      .update(updateData)\n      .eq('id', id)\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error updating prep list:', error);\n      return NextResponse.json({ \n        error: 'Failed to update prep list',\n        message: 'Could not update prep list data'\n      }, { status: 500 });\n    }\n\n    // Update items if provided\n    if (items !== undefined) {\n      // Delete existing items\n      await supabaseAdmin\n        .from('prep_list_items')\n        .delete()\n        .eq('prep_list_id', id);\n\n      // Add new items\n      if (items.length > 0) {\n        const prepItems = items.map((item: any) => ({\n          prep_list_id: id,\n          ingredient_id: item.ingredientId,\n          quantity: item.quantity,\n          unit: item.unit,\n          notes: item.notes\n        }));\n\n        await supabaseAdmin\n          .from('prep_list_items')\n          .insert(prepItems);\n      }\n    }\n\n    return NextResponse.json({ \n      success: true,\n      message: 'Prep list updated successfully',\n      data\n    });\n\n  } catch (error) {\n    console.error('Prep lists API error:', error);\n    return NextResponse.json({ \n      error: 'Internal server error',\n      message: 'An unexpected error occurred'\n    }, { status: 500 });\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const id = searchParams.get('id');\n\n    if (!id) {\n      return NextResponse.json({ \n        error: 'Missing ID',\n        message: 'Prep list ID is required'\n      }, { status: 400 });\n    }\n\n    if (!supabaseAdmin) {\n      return NextResponse.json({ \n        error: 'Database connection not available' \n      }, { status: 500 });\n    }\n\n    // Delete prep list items first (foreign key constraint)\n    await supabaseAdmin\n      .from('prep_list_items')\n      .delete()\n      .eq('prep_list_id', id);\n\n    // Delete the prep list\n    const { error } = await supabaseAdmin\n      .from('prep_lists')\n      .delete()\n      .eq('id', id);\n\n    if (error) {\n      console.error('Error deleting prep list:', error);\n      return NextResponse.json({ \n        error: 'Failed to delete prep list',\n        message: 'Could not remove prep list'\n      }, { status: 500 });\n    }\n\n    return NextResponse.json({ \n      success: true,\n      message: 'Prep list deleted successfully'\n    });\n\n  } catch (error) {\n    console.error('Prep lists API error:', error);\n    return NextResponse.json({ \n      error: 'Internal server error',\n      message: 'An unexpected error occurred'\n    }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}