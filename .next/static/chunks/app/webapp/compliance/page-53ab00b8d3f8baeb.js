(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4168],{54867:(e,a,s)=>{Promise.resolve().then(s.bind(s,95932))},95932:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var t=s(95155),r=s(12115),n=s(34908),l=s(44588),c=s(12104);function i(){let{t:e}=(0,n.Bd)(),[a,s]=(0,r.useState)([]),[i,o]=(0,r.useState)([]),[d,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)("records"),[u,h]=(0,r.useState)(!1),[b,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)("all"),[j,v]=(0,r.useState)("all"),[N,w]=(0,r.useState)({compliance_type_id:"",document_name:"",issue_date:"",expiry_date:"",document_url:"",photo_url:"",notes:"",reminder_enabled:!0,reminder_days_before:30}),[_,C]=(0,r.useState)({name:"",description:"",renewal_frequency_days:""});(0,r.useEffect)(()=>{D(),E()},[f,j]);let D=async()=>{try{let e=await fetch("/api/compliance-types"),a=await e.json();a.success&&s(a.data)}catch(e){console.error("Error fetching types:",e)}},E=async()=>{try{let e="/api/compliance-records",a=new URLSearchParams;"all"!==f&&a.append("type_id",f),"all"!==j&&a.append("status",j),a.toString()&&(e+="?".concat(a.toString()));let s=await fetch(e),t=await s.json();t.success&&o(t.data)}catch(e){console.error("Error fetching records:",e)}finally{m(!1)}},k=async e=>{e.preventDefault();try{let e=await fetch("/api/compliance-records",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...N,compliance_type_id:parseInt(N.compliance_type_id),reminder_days_before:parseInt(N.reminder_days_before.toString())})}),a=await e.json();a.success&&(o([a.data,...i]),w({compliance_type_id:"",document_name:"",issue_date:"",expiry_date:"",document_url:"",photo_url:"",notes:"",reminder_enabled:!0,reminder_days_before:30}),h(!1))}catch(e){console.error("Error adding record:",e)}},S=async e=>{e.preventDefault();try{let e=await fetch("/api/compliance-types",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({..._,renewal_frequency_days:_.renewal_frequency_days?parseInt(_.renewal_frequency_days):null})}),t=await e.json();t.success&&(s([...a,t.data]),C({name:"",description:"",renewal_frequency_days:""}),g(!1))}catch(e){console.error("Error adding type:",e)}},T=e=>{let a=e.toLowerCase();return a.includes("pest")?"\uD83D\uDC1B":a.includes("council")?"\uD83C\uDFDB️":a.includes("food")||a.includes("license")?"\uD83C\uDF7D️":a.includes("fire")?"\uD83D\uDD25":a.includes("insurance")?"\uD83D\uDEE1️":"\uD83D\uDCCB"};return d?(0,t.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(c.O0,{variant:"stats",height:"64px"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-8",children:(0,t.jsx)(c.O0,{variant:"card",count:4,height:"120px"})})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-4xl font-bold text-white mb-2",children:["\uD83D\uDCCB ",e("compliance.title","Compliance Tracking")]}),(0,t.jsx)("p",{className:"text-gray-400",children:e("compliance.subtitle","Track pest control, council inspections, licenses, and other compliance documents with automated reminders")})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex space-x-1 bg-[#1f1f1f] p-1 rounded-2xl border border-[#2a2a2a]",children:[(0,t.jsxs)("button",{onClick:()=>p("records"),className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 ".concat("records"===x?"bg-[#29E7CD] text-black shadow-lg":"text-gray-400 hover:text-white"),children:["\uD83D\uDCC4 ",e("compliance.records","Compliance Records")]}),(0,t.jsxs)("button",{onClick:()=>p("types"),className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 ".concat("types"===x?"bg-[#29E7CD] text-black shadow-lg":"text-gray-400 hover:text-white"),children:["\uD83C\uDFF7️ ",e("compliance.types","Compliance Types")]})]})}),"records"===x&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.filterType","Filter by Type")}),(0,t.jsxs)("select",{value:f,onChange:e=>y(e.target.value),className:"px-4 py-2 bg-[#2a2a2a] border border-[#2a2a2a] rounded-xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",children:[(0,t.jsx)("option",{value:"all",children:e("compliance.allTypes","All Types")}),a.map(e=>(0,t.jsxs)("option",{value:e.id.toString(),children:[T(e.name)," ",e.name]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.filterStatus","Filter by Status")}),(0,t.jsxs)("select",{value:j,onChange:e=>v(e.target.value),className:"px-4 py-2 bg-[#2a2a2a] border border-[#2a2a2a] rounded-xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",children:[(0,t.jsx)("option",{value:"all",children:e("compliance.allStatuses","All Statuses")}),(0,t.jsxs)("option",{value:"active",children:["✅ ",e("compliance.active","Active")]}),(0,t.jsxs)("option",{value:"pending_renewal",children:["⚠️ ",e("compliance.pendingRenewal","Pending Renewal")]}),(0,t.jsxs)("option",{value:"expired",children:["❌ ",e("compliance.expired","Expired")]})]})]})]}),(0,t.jsxs)("button",{onClick:()=>h(!0),className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-6 py-3 rounded-2xl font-semibold hover:shadow-xl transition-all duration-200",children:["➕ ",e("compliance.addRecord","Add Compliance Record")]})]}),u&&(0,t.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a]",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:e("compliance.addNewRecord","Add New Compliance Record")}),(0,t.jsxs)("form",{onSubmit:k,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.complianceType","Compliance Type")}),(0,t.jsxs)("select",{value:N.compliance_type_id,onChange:e=>w({...N,compliance_type_id:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0,children:[(0,t.jsx)("option",{value:"",children:e("compliance.selectType","Choose a compliance type")}),a.map(e=>(0,t.jsxs)("option",{value:e.id,children:[T(e.name)," ",e.name]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.documentName","Document Name")}),(0,t.jsx)("input",{type:"text",value:N.document_name,onChange:e=>w({...N,document_name:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Annual Pest Control Certificate",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.issueDate","Issue Date")}),(0,t.jsx)("input",{type:"date",value:N.issue_date,onChange:e=>w({...N,issue_date:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.expiryDate","Expiry Date")}),(0,t.jsx)("input",{type:"date",value:N.expiry_date,onChange:e=>w({...N,expiry_date:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.documentUrl","Document URL")}),(0,t.jsx)("input",{type:"url",value:N.document_url,onChange:e=>w({...N,document_url:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Link to digital document"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.reminderDays","Reminder Days Before")}),(0,t.jsx)("input",{type:"number",value:N.reminder_days_before,onChange:e=>w({...N,reminder_days_before:parseInt(e.target.value)}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",min:"1",max:"365"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.notes","Notes")}),(0,t.jsx)("textarea",{value:N.notes,onChange:e=>w({...N,notes:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Additional notes or observations",rows:3})]}),(0,t.jsx)("div",{className:"md:col-span-2 flex items-center space-x-4",children:(0,t.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:N.reminder_enabled,onChange:e=>w({...N,reminder_enabled:e.target.checked}),className:"w-4 h-4 text-[#29E7CD] bg-[#2a2a2a] border-[#2a2a2a] rounded focus:ring-[#29E7CD]"}),(0,t.jsx)("span",{className:"text-gray-300",children:e("compliance.enableReminders","Enable automated reminders")})]})}),(0,t.jsxs)("div",{className:"md:col-span-2 flex space-x-4",children:[(0,t.jsx)("button",{type:"submit",className:"bg-[#29E7CD] text-black px-6 py-3 rounded-2xl font-semibold hover:shadow-xl transition-all duration-200",children:e("compliance.save","Save Record")}),(0,t.jsx)("button",{type:"button",onClick:()=>h(!1),className:"bg-[#2a2a2a] text-white px-6 py-3 rounded-2xl font-semibold hover:bg-[#3a3a3a] transition-all duration-200",children:e("compliance.cancel","Cancel")})]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:0===i.length?(0,t.jsxs)("div",{className:"bg-[#1f1f1f] p-8 rounded-3xl shadow-lg border border-[#2a2a2a] text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-[#29E7CD]/20 to-[#29E7CD]/10 flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("span",{className:"text-4xl",children:"\uD83D\uDCCB"})}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:e("compliance.noRecords","No Compliance Records")}),(0,t.jsx)("p",{className:"text-gray-400",children:e("compliance.noRecordsDesc","Start tracking your compliance documents and licenses")})]}):i.map(a=>{let s=(e=>{if(!e)return null;let a=new Date;return Math.ceil((new Date(e).getTime()-a.getTime())/864e5)})(a.expiry_date);return(0,t.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a] hover:shadow-xl transition-all duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-[#29E7CD]/20 to-[#29E7CD]/10 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-2xl",children:T(a.compliance_types.name)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white",children:a.document_name}),(0,t.jsx)("p",{className:"text-gray-400",children:a.compliance_types.name})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"expired":return"text-red-400 bg-red-400/10 border-red-400/20";case"pending_renewal":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/20";default:return"text-green-400 bg-green-400/10 border-green-400/20"}})(a.status)),children:[(e=>{switch(e){case"expired":return"❌";case"pending_renewal":return"⚠️";default:return"✅"}})(a.status)," ",a.status.charAt(0).toUpperCase()+a.status.slice(1).replace("_"," ")]}),null!==s&&(0,t.jsx)("span",{className:"text-sm font-semibold ".concat(s<0?"text-red-400":s<30?"text-yellow-400":"text-green-400"),children:s<0?"".concat(Math.abs(s)," days overdue"):0===s?"Expires today":"".concat(s," days left")})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[a.issue_date&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:[e("compliance.issueDate","Issue Date"),": "]}),(0,t.jsx)("span",{className:"text-white",children:new Date(a.issue_date).toLocaleDateString()})]}),a.expiry_date&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:[e("compliance.expiryDate","Expiry Date"),": "]}),(0,t.jsx)("span",{className:"text-white",children:new Date(a.expiry_date).toLocaleDateString()})]})]}),a.notes&&(0,t.jsx)("p",{className:"text-gray-300 mb-4",children:a.notes}),(a.document_url||a.photo_url)&&(0,t.jsxs)("div",{className:"mb-4 flex space-x-4",children:[a.document_url&&(0,t.jsxs)("a",{href:a.document_url,target:"_blank",rel:"noopener noreferrer",className:"bg-[#29E7CD] text-black px-4 py-2 rounded-xl font-semibold hover:shadow-lg transition-all duration-200",children:["\uD83D\uDCC4 ",e("compliance.viewDocument","View Document")]}),a.photo_url&&(0,t.jsx)(l.A,{src:a.photo_url,alt:"Compliance document",width:128,height:128,className:"w-32 h-32 object-cover rounded-2xl border border-[#2a2a2a]"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(a.reminder_enabled?"bg-green-400":"bg-gray-400")}),(0,t.jsx)("span",{className:"text-sm text-gray-400",children:a.reminder_enabled?e("compliance.remindersEnabled","Reminders enabled"):e("compliance.remindersDisabled","Reminders disabled")})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsxs)("button",{className:"bg-[#2a2a2a] text-white px-4 py-2 rounded-xl font-semibold hover:bg-[#3a3a3a] transition-all duration-200",children:["\uD83D\uDCF7 ",e("compliance.addPhoto","Add Photo")]}),(0,t.jsxs)("button",{className:"bg-[#2a2a2a] text-white px-4 py-2 rounded-xl font-semibold hover:bg-[#3a3a3a] transition-all duration-200",children:["✏️ ",e("compliance.edit","Edit")]})]})]})]},a.id)})})]}),"types"===x&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold text-white",children:e("compliance.manageTypes","Manage Compliance Types")}),(0,t.jsxs)("button",{onClick:()=>g(!0),className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-6 py-3 rounded-2xl font-semibold hover:shadow-xl transition-all duration-200",children:["➕ ",e("compliance.addType","Add Type")]})]}),b&&(0,t.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a]",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:e("compliance.addNewType","Add New Compliance Type")}),(0,t.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.typeName","Type Name")}),(0,t.jsx)("input",{type:"text",value:_.name,onChange:e=>C({..._,name:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Pest Control, Council Inspection",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.description","Description")}),(0,t.jsx)("textarea",{value:_.description,onChange:e=>C({..._,description:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Describe this compliance type",rows:3})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e("compliance.renewalFrequency","Renewal Frequency (days)")}),(0,t.jsx)("input",{type:"number",value:_.renewal_frequency_days,onChange:e=>C({..._,renewal_frequency_days:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 365 for annual"})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)("button",{type:"submit",className:"bg-[#29E7CD] text-black px-6 py-3 rounded-2xl font-semibold hover:shadow-xl transition-all duration-200",children:e("compliance.save","Save Type")}),(0,t.jsx)("button",{type:"button",onClick:()=>g(!1),className:"bg-[#2a2a2a] text-white px-6 py-3 rounded-2xl font-semibold hover:bg-[#3a3a3a] transition-all duration-200",children:e("compliance.cancel","Cancel")})]})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(a=>(0,t.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a] hover:shadow-xl transition-all duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-[#29E7CD]/20 to-[#29E7CD]/10 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-2xl",children:T(a.name)})}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(a.is_active?"bg-green-400/10 text-green-400 border border-green-400/20":"bg-gray-400/10 text-gray-400 border border-gray-400/20"),children:a.is_active?e("compliance.active","Active"):e("compliance.inactive","Inactive")})]}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:a.name}),(0,t.jsx)("p",{className:"text-gray-400 mb-4",children:a.description||e("compliance.noDescription","No description provided")}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:a.renewal_frequency_days?"".concat(e("compliance.everyDays","Every")," ").concat(a.renewal_frequency_days," ").concat(e("compliance.days","days")):e("compliance.noFrequency","No renewal frequency set")}),(0,t.jsx)("button",{className:"text-[#29E7CD] hover:text-[#29E7CD]/80 transition-colors",children:e("compliance.edit","Edit")})]})]},a.id))})]})]})})}}},e=>{e.O(0,[563,8650,8405,9420,622,7979,1899,4450,9324,8585,9592,433,2652,3494,2574,9173,3023,1356,309,4191,2834,957,6691,1151,9473,9219,6053,3376,2076,7358],()=>e(e.s=54867)),_N_E=e.O()}]);