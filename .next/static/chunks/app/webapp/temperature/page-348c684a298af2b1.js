(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6515],{9492:()=>{},41032:(e,t,a)=>{Promise.resolve().then(a.bind(a,50378))},50378:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var s=a(95155),l=a(12115),r=a(34908),n=a(53649),i=a(84920);function o(){let{countryConfig:e}=(0,n.S)();return{countryConfig:e,formatCurrency:function(t){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,i.KV)(t,e.code,a)},formatDate:(t,a)=>new Intl.DateTimeFormat(e.locale,a).format(t),formatNumber:(t,a)=>new Intl.NumberFormat(e.locale,a).format(t),formatPercentage:t=>new Intl.NumberFormat(e.locale,{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1}).format(t),calculateTax:t=>(0,i.BX)(t,e.code),getTaxInfo:()=>({rate:e.taxRate,name:e.taxName,currency:e.currency})}}var c=a(4929),d=a(44588);let m=[{value:"fridge",label:"Fridge",icon:"\uD83E\uDDCA"},{value:"freezer",label:"Freezer",icon:"❄️"},{value:"food_cooking",label:"Food Cooking",icon:"\uD83D\uDD25"},{value:"food_hot_holding",label:"Food Hot Holding",icon:"\uD83C\uDF72"},{value:"food_cold_holding",label:"Food Cold Holding",icon:"\uD83E\uDD57"},{value:"storage",label:"Storage",icon:"\uD83D\uDCE6"}];function u(e){let{logs:t,equipment:a,selectedDate:l,setSelectedDate:n,selectedType:i,setSelectedType:c,showAddLog:u,setShowAddLog:x,newLog:g,setNewLog:p,onAddLog:h,onRefreshLogs:f}=e,{t:b}=(0,r.Bd)(),{formatDate:j}=o(),y=e=>{let t=m.find(t=>t.value===e);return(null==t?void 0:t.icon)||"\uD83C\uDF21️"},v=e=>{let t=m.find(t=>t.value===e);return(null==t?void 0:t.label)||e};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.filterDate","Filter by Date")}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{let e=new Date(l);e.setDate(e.getDate()-1),n(e.toISOString().split("T")[0])},className:"bg-[#2a2a2a] text-white px-3 py-2 rounded-xl hover:bg-[#3a3a3a] transition-all duration-200 flex items-center justify-center",title:"Previous day",children:(0,s.jsx)("span",{className:"text-lg",children:"←"})}),(0,s.jsx)("input",{type:"date",value:l,onChange:e=>n(e.target.value),className:"px-4 py-2 bg-[#2a2a2a] border border-[#2a2a2a] rounded-xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent"}),(0,s.jsx)("button",{onClick:()=>{let e=new Date(l);e.setDate(e.getDate()+1),n(e.toISOString().split("T")[0])},className:"bg-[#2a2a2a] text-white px-3 py-2 rounded-xl hover:bg-[#3a3a3a] transition-all duration-200 flex items-center justify-center",title:"Next day",children:(0,s.jsx)("span",{className:"text-lg",children:"→"})}),(0,s.jsx)("button",{onClick:()=>{n(new Date().toISOString().split("T")[0])},className:"bg-[#29E7CD]/10 text-[#29E7CD] px-3 py-2 rounded-xl hover:bg-[#29E7CD]/20 transition-all duration-200 text-sm font-medium",title:"Go to today",children:"Today"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.filterEquipment","Filter by Equipment")}),(0,s.jsxs)("select",{value:i,onChange:e=>c(e.target.value),className:"px-4 py-2 bg-[#2a2a2a] border border-[#2a2a2a] rounded-xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",children:[(0,s.jsx)("option",{value:"all",children:b("temperature.allEquipment","All Equipment")}),a.filter(e=>e.is_active).map(e=>(0,s.jsxs)("option",{value:e.equipment_type,children:[y(e.equipment_type)," ",e.name]},e.id)),m.filter(e=>"food_cooking"===e.value||"food_hot_holding"===e.value||"food_cold_holding"===e.value).map(e=>(0,s.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))]})]})]}),(0,s.jsxs)("button",{onClick:()=>x(!0),className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-6 py-3 rounded-2xl font-semibold hover:shadow-xl transition-all duration-200",children:["➕ ",b("temperature.addLog","Add Temperature Log")]})]}),u&&(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a]",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:b("temperature.addNewLog","Add New Temperature Log")}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"\uD83D\uDCA1 You can log multiple temperatures per day for the same equipment (e.g., morning and evening checks). There's a 5-minute cooling off period between entries for the same equipment."}),(0,s.jsxs)("div",{className:"mb-4 p-4 bg-blue-400/10 border border-blue-400/20 rounded-2xl",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-blue-400 mb-2",children:"\uD83C\uDF7D️ Queensland 2-Hour/4-Hour Rule"}),(0,s.jsxs)("div",{className:"text-xs text-gray-300 space-y-1",children:[(0,s.jsxs)("p",{children:["• ",(0,s.jsx)("span",{className:"text-green-400",children:"0-2 hours"})," in danger zone (5\xb0C-60\xb0C): Can refrigerate for later use"]}),(0,s.jsxs)("p",{children:["• ",(0,s.jsx)("span",{className:"text-yellow-400",children:"2-4 hours"})," in danger zone: Must use immediately"]}),(0,s.jsxs)("p",{children:["• ",(0,s.jsx)("span",{className:"text-red-400",children:"4+ hours"})," in danger zone: Must discard"]})]})]}),(0,s.jsxs)("form",{onSubmit:h,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.date","Date")}),(0,s.jsx)("input",{type:"date",value:g.log_date,onChange:e=>p({...g,log_date:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.time","Time")}),(0,s.jsx)("input",{type:"time",value:g.log_time,onChange:e=>p({...g,log_time:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.equipment","Equipment")}),(0,s.jsxs)("select",{value:g.temperature_type,onChange:e=>{let t=a.find(t=>t.equipment_type===e.target.value);p({...g,temperature_type:e.target.value,location:(null==t?void 0:t.name)||""})},className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0,children:[(0,s.jsx)("option",{value:"",children:b("temperature.selectEquipment","Select Equipment")}),a.filter(e=>e.is_active).map(e=>(0,s.jsxs)("option",{value:e.equipment_type,children:[y(e.equipment_type)," ",e.name," (",v(e.equipment_type),")"]},e.id)),m.filter(e=>"food_cooking"===e.value||"food_hot_holding"===e.value||"food_cold_holding"===e.value).map(e=>(0,s.jsxs)("option",{value:e.value,children:[e.icon," ",e.label," (Food Safety)"]},e.value))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.temperature","Temperature (\xb0C)")}),(0,s.jsx)("input",{type:"number",step:"0.1",value:g.temperature_celsius,onChange:e=>p({...g,temperature_celsius:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 3.5",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["food_cooking","food_hot_holding","food_cold_holding"].includes(g.temperature_type)?b("temperature.foodItem","Food Item"):b("temperature.location","Location")}),(0,s.jsx)("input",{type:"text",value:g.location,onChange:e=>p({...g,location:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:["food_cooking","food_hot_holding","food_cold_holding"].includes(g.temperature_type)?"e.g., Chicken Curry, Soup Station 1, Salad Bar":"e.g., Main Fridge, Freezer 1",required:["food_cooking","food_hot_holding","food_cold_holding"].includes(g.temperature_type)}),["food_cooking","food_hot_holding","food_cold_holding"].includes(g.temperature_type)&&(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"\uD83D\uDCA1 Specify the exact food item for proper 2-hour/4-hour rule tracking"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.loggedBy","Logged By")}),(0,s.jsx)("input",{type:"text",value:g.logged_by,onChange:e=>p({...g,logged_by:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Staff member name"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:b("temperature.notes","Notes")}),(0,s.jsx)("textarea",{value:g.notes,onChange:e=>p({...g,notes:e.target.value}),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Additional notes or observations",rows:3})]}),(0,s.jsxs)("div",{className:"md:col-span-2 flex space-x-4",children:[(0,s.jsx)("button",{type:"submit",className:"bg-[#29E7CD] text-black px-6 py-3 rounded-2xl font-semibold hover:shadow-xl transition-all duration-200",children:b("temperature.save","Save Log")}),(0,s.jsx)("button",{type:"button",onClick:()=>x(!1),className:"bg-[#2a2a2a] text-white px-6 py-3 rounded-2xl font-semibold hover:bg-[#3a3a3a] transition-all duration-200",children:b("temperature.cancel","Cancel")})]})]})]}),(0,s.jsx)("div",{className:"space-y-6",children:0===t.length?(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-8 rounded-3xl shadow-lg border border-[#2a2a2a] text-center",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-[#29E7CD]/20 to-[#29E7CD]/10 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("span",{className:"text-4xl",children:"\uD83C\uDF21️"})}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:b("temperature.noLogs","No Temperature Logs")}),(0,s.jsx)("p",{className:"text-gray-400",children:b("temperature.noLogsDesc","Start logging temperatures to ensure food safety compliance")})]}):(e=>{let t=e.reduce((e,t)=>{let a=(e=>{let t=parseInt(e.split(":")[0]);return t>=5&&t<9?{period:"morning",label:"\uD83C\uDF05 Morning (5:00-8:59)",icon:"\uD83C\uDF05"}:t>=9&&t<12?{period:"late-morning",label:"☀️ Late Morning (9:00-11:59)",icon:"☀️"}:t>=12&&t<14?{period:"midday",label:"\uD83C\uDF1E Midday (12:00-13:59)",icon:"\uD83C\uDF1E"}:t>=14&&t<17?{period:"afternoon",label:"\uD83C\uDF24️ Afternoon (14:00-16:59)",icon:"\uD83C\uDF24️"}:t>=17&&t<20?{period:"dinner",label:"\uD83C\uDF06 Dinner Prep (17:00-19:59)",icon:"\uD83C\uDF06"}:t>=20&&t<22?{period:"evening",label:"\uD83C\uDF19 Evening (20:00-21:59)",icon:"\uD83C\uDF19"}:{period:"night",label:"\uD83C\uDF1A Night (22:00-4:59)",icon:"\uD83C\uDF1A"}})(t.log_time);return e[a.period]||(e[a.period]={period:a.period,label:a.label,icon:a.icon,logs:[]}),e[a.period].logs.push(t),e},{});return["morning","late-morning","midday","afternoon","dinner","evening","night"].filter(e=>t[e]).map(e=>t[e]).map(e=>({...e,logs:e.logs.sort((e,t)=>e.log_time.localeCompare(t.log_time))}))})(t).map(e=>(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-2xl bg-gradient-to-br from-[#29E7CD]/20 to-[#29E7CD]/10 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-xl",children:e.icon})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.label}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:[e.logs.length," temperature reading",1!==e.logs.length?"s":""]})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:e.logs.map(e=>{let t=((e,t)=>{let s=a.find(e=>e.name===t);return s&&s.is_active?s.min_temp_celsius&&e<s.min_temp_celsius?"low":s.max_temp_celsius&&e>s.max_temp_celsius?"high":"normal":"normal"})(e.temperature_celsius,e.location||""),l=((e,t,a,s)=>{if("food_cooking"!==s&&"food_hot_holding"!==s&&"food_cold_holding"!==s)return null;if(e<5||e>60)return{status:"safe",message:"Outside danger zone",color:"text-green-400",icon:"✅"};let l=new Date("".concat(a,"T").concat(t)),r=(new Date().getTime()-l.getTime())/36e5;return r<2?{status:"safe",message:"".concat((2-r).toFixed(1),"h remaining - can refrigerate"),color:"text-green-400",icon:"✅"}:r<4?{status:"warning",message:"".concat((4-r).toFixed(1),"h remaining - use immediately"),color:"text-yellow-400",icon:"⚠️"}:{status:"danger",message:"".concat(r.toFixed(1),"h in danger zone - DISCARD"),color:"text-red-400",icon:"\uD83D\uDEA8"}})(e.temperature_celsius,e.log_time,e.log_date,e.temperature_type);return(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-4 rounded-2xl shadow-lg border border-[#2a2a2a] hover:shadow-xl transition-all duration-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#29E7CD]/20 to-[#29E7CD]/10 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-lg",children:y(e.temperature_type)})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-white",children:e.location||v(e.temperature_type)}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:e.log_time}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"•"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:v(e.temperature_type)})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"high":return"text-red-400 bg-red-400/10 border-red-400/20";case"low":return"text-blue-400 bg-blue-400/10 border-blue-400/20";default:return"text-green-400 bg-green-400/10 border-green-400/20"}})(t)),children:"high"===t?"⚠️ High":"low"===t?"⚠️ Low":"✅ Normal"}),(0,s.jsxs)("span",{className:"text-xl font-bold text-[#29E7CD]",children:[e.temperature_celsius,"\xb0C"]})]})]}),e.location&&e.location!==v(e.temperature_type)&&(0,s.jsxs)("p",{className:"text-gray-300 text-sm mb-2",children:["\uD83D\uDCCD ",e.location]}),e.logged_by&&(0,s.jsxs)("p",{className:"text-xs text-gray-400 mb-2",children:["\uD83D\uDC64 ",b("temperature.loggedBy","Logged by"),": ",e.logged_by]}),e.notes&&(0,s.jsx)("p",{className:"text-gray-300 text-sm mb-3",children:e.notes}),l&&(0,s.jsx)("div",{className:"mb-3 p-3 rounded-xl border ".concat(l.color.replace("text-","bg-").replace("-400","-400/10")," border-").concat(l.color.replace("text-","").replace("-400","-400/20")),children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-lg",children:l.icon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium ".concat(l.color),children:"Queensland 2-Hour/4-Hour Rule"}),(0,s.jsx)("p",{className:"text-xs ".concat(l.color),children:l.message})]})]})}),e.photo_url&&(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)(d.A,{src:e.photo_url,alt:"Temperature reading",width:96,height:96,className:"w-24 h-24 object-cover rounded-xl border border-[#2a2a2a]"})}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)("button",{className:"bg-[#2a2a2a] text-white px-3 py-1 rounded-lg font-semibold hover:bg-[#3a3a3a] transition-all duration-200 text-sm",children:["\uD83D\uDCF7 ",b("temperature.addPhoto","Add Photo")]}),(0,s.jsxs)("button",{className:"bg-[#2a2a2a] text-white px-3 py-1 rounded-lg font-semibold hover:bg-[#3a3a3a] transition-all duration-200 text-sm",children:["✏️ ",b("temperature.edit","Edit")]})]})]},e.id)})})]},e.period))})]})}let x=[{value:"fridge",label:"Fridge",icon:"\uD83E\uDDCA"},{value:"freezer",label:"Freezer",icon:"❄️"},{value:"food_cooking",label:"Food Cooking",icon:"\uD83D\uDD25"},{value:"food_hot_holding",label:"Food Hot Holding",icon:"\uD83C\uDF72"},{value:"food_cold_holding",label:"Food Cold Holding",icon:"\uD83E\uDD57"},{value:"storage",label:"Storage",icon:"\uD83D\uDCE6"}];function g(e){let{equipment:t,quickTempLoading:a,onUpdateEquipment:n,onCreateEquipment:i,onDeleteEquipment:o,onQuickTempLog:c}=e,{t:d}=(0,r.Bd)(),[m,u]=(0,l.useState)(null),[g,p]=(0,l.useState)({name:"",equipmentType:"",location:"",minTemp:null,maxTemp:null}),[h,f]=(0,l.useState)(!1),b=async e=>{e.preventDefault();try{await i(g.name,g.equipmentType,g.location||null,g.minTemp,g.maxTemp),p({name:"",equipmentType:"",location:"",minTemp:null,maxTemp:null}),f(!1)}catch(e){}},j=async(e,t)=>{try{await n(e,t),u(null)}catch(e){}},y=async e=>{if(confirm("Are you sure you want to delete this equipment? This will also delete all associated temperature logs."))try{await o(e)}catch(e){}},v=async(e,t)=>{try{await n(e,{is_active:!t})}catch(e){}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-white",children:d("temperature.equipment","Temperature Equipment")}),(0,s.jsx)("p",{className:"text-gray-400 mt-1",children:d("temperature.equipmentDesc","Manage your temperature monitoring equipment")})]}),(0,s.jsxs)("button",{onClick:()=>f(!h),className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-6 py-3 rounded-2xl font-semibold hover:shadow-xl transition-all duration-200 flex items-center space-x-2",children:[(0,s.jsx)("span",{children:"➕"}),(0,s.jsx)("span",{children:d("temperature.addEquipment","Add Equipment")})]})]}),h&&(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a]",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"➕ Add New Equipment"}),(0,s.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Equipment Name"}),(0,s.jsx)("input",{type:"text",value:g.name,onChange:e=>p({...g,name:e.target.value}),className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Main Fridge, Freezer 1",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Equipment Type"}),(0,s.jsxs)("select",{value:g.equipmentType,onChange:e=>p({...g,equipmentType:e.target.value}),className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select type..."}),x.map(e=>(0,s.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location (Optional)"}),(0,s.jsx)("input",{type:"text",value:g.location,onChange:e=>p({...g,location:e.target.value}),className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Kitchen, Storage Room"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Temperature (\xb0C)"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:g.minTemp||"",onChange:e=>p({...g,minTemp:e.target.value?parseFloat(e.target.value):null}),className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Optional"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Temperature (\xb0C)"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:g.maxTemp||"",onChange:e=>p({...g,maxTemp:e.target.value?parseFloat(e.target.value):null}),className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Optional"})]})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("button",{type:"submit",className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-6 py-3 rounded-xl font-semibold hover:shadow-xl transition-all duration-200",children:"Add Equipment"}),(0,s.jsx)("button",{type:"button",onClick:()=>f(!1),className:"bg-[#2a2a2a] text-gray-300 px-6 py-3 rounded-xl font-semibold hover:bg-[#3a3a3a] transition-all duration-200",children:"Cancel"})]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:0===t.length?(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-8 rounded-3xl shadow-lg border border-[#2a2a2a] text-center",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDF21️"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"No Equipment Added"}),(0,s.jsx)("p",{className:"text-gray-400 mb-4",children:"Add temperature monitoring equipment to start tracking"}),(0,s.jsx)("button",{onClick:()=>f(!0),className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-6 py-3 rounded-xl font-semibold hover:shadow-xl transition-all duration-200",children:"Add Your First Equipment"})]}):t.map(e=>(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"text-3xl",children:(e=>{let t=x.find(t=>t.value===e);return(null==t?void 0:t.icon)||"\uD83C\uDF21️"})(e.equipment_type)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.name}),(0,s.jsx)("p",{className:"text-gray-400",children:(e=>{let t=x.find(t=>t.value===e);return(null==t?void 0:t.label)||e})(e.equipment_type)}),e.location&&(0,s.jsxs)("p",{className:"text-gray-500 text-sm",children:["\uD83D\uDCCD ",e.location]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"Temperature Range"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-white",children:e.min_temp_celsius&&e.max_temp_celsius?"".concat(e.min_temp_celsius,"\xb0C - ").concat(e.max_temp_celsius,"\xb0C"):"Not set"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.is_active?"bg-green-400":"bg-gray-400")}),(0,s.jsx)("span",{className:"text-sm text-gray-300",children:e.is_active?"Active":"Inactive"})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>c(e.id,e.name,e.equipment_type),disabled:a[e.id]||!e.is_active,className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-4 py-2 rounded-xl font-semibold hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:a[e.id]?"Logging...":"Quick Log"}),(0,s.jsx)("button",{onClick:()=>v(e.id,e.is_active),className:"px-3 py-2 rounded-xl font-semibold transition-all duration-200 text-sm ".concat(e.is_active?"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30":"bg-green-500/20 text-green-400 hover:bg-green-500/30"),children:e.is_active?"Deactivate":"Activate"}),(0,s.jsx)("button",{onClick:()=>u(m===e.id?null:e.id),className:"bg-[#2a2a2a] text-gray-300 px-3 py-2 rounded-xl hover:bg-[#3a3a3a] transition-all duration-200 text-sm",children:m===e.id?"Cancel":"Edit"}),(0,s.jsx)("button",{onClick:()=>y(e.id),className:"bg-red-500/20 text-red-400 px-3 py-2 rounded-xl hover:bg-red-500/30 transition-all duration-200 text-sm",children:"Delete"})]})]})]}),m===e.id&&(0,s.jsx)("div",{className:"mt-6 pt-6 border-t border-[#2a2a2a]",children:(0,s.jsxs)("form",{onSubmit:t=>{t.preventDefault();let a=new FormData(t.currentTarget);j(e.id,{name:a.get("name"),equipment_type:a.get("equipmentType"),location:a.get("location")||null,min_temp_celsius:a.get("minTemp")?parseFloat(a.get("minTemp")):null,max_temp_celsius:a.get("maxTemp")?parseFloat(a.get("maxTemp")):null})},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Equipment Name"}),(0,s.jsx)("input",{type:"text",name:"name",defaultValue:e.name,className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Equipment Type"}),(0,s.jsx)("select",{name:"equipmentType",defaultValue:e.equipment_type,className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0,children:x.map(e=>(0,s.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location"}),(0,s.jsx)("input",{type:"text",name:"location",defaultValue:e.location||"",className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Optional"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Temperature (\xb0C)"}),(0,s.jsx)("input",{type:"number",step:"0.1",name:"minTemp",defaultValue:e.min_temp_celsius||"",className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Optional"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Temperature (\xb0C)"}),(0,s.jsx)("input",{type:"number",step:"0.1",name:"maxTemp",defaultValue:e.max_temp_celsius||"",className:"w-full bg-[#2a2a2a] border border-[#3a3a3a] rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Optional"})]})]}),(0,s.jsx)("div",{className:"flex space-x-3",children:(0,s.jsx)("button",{type:"submit",className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-black px-6 py-3 rounded-xl font-semibold hover:shadow-xl transition-all duration-200",children:"Update Equipment"})})]})})]},e.id))})]})}a(9492);var p=a(68425),h=a(47643),f=a(80019),b=a(48716),j=a(26991),y=a(96112),v=a(47734),N=a(73697);function w(e){let{logs:t,equipment:a,timeFilter:r}=e,[n,i]=(0,l.useState)(!1),o=(()=>{let e;if(!a||!a.name)return[];let s=t.filter(e=>e.location===a.name);if(0===s.length)return[];let l=s.sort((e,t)=>{let a=new Date("".concat(e.log_date,"T").concat(e.log_time)),s=new Date("".concat(t.log_date,"T").concat(t.log_time));return a.getTime()-s.getTime()}),n=l[l.length-1],i=new Date("".concat(n.log_date,"T").concat(n.log_time));switch(r){case"24h":e=new Date(i.getTime()-864e5);break;case"7d":e=new Date(i.getTime()-6048e5);break;case"30d":e=new Date(i.getTime()-2592e6);break;default:return l}return l.filter(t=>new Date("".concat(t.log_date,"T").concat(t.log_time))>=e)})().map(e=>({timestamp:"".concat(e.log_date,"T").concat(e.log_time),temperature:e.temperature_celsius,time:new Date("".concat(e.log_date,"T").concat(e.log_time)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),date:new Date("".concat(e.log_date,"T").concat(e.log_time)).toLocaleDateString()}));return((0,l.useEffect)(()=>{if(o.length>0&&a&&a.name){let e=setTimeout(()=>{i(!0)},200);return()=>clearTimeout(e)}i(!1)},[o.length,null==a?void 0:a.name,r]),n&&0!==o.length&&a&&a.name)?(0,s.jsx)("div",{className:"w-full h-96",children:(0,s.jsx)(j.u,{width:"100%",height:"100%",children:(0,s.jsxs)(f.b,{data:o,margin:{top:20,right:30,left:20,bottom:20},children:[(0,s.jsx)(p.d,{strokeDasharray:"3 3",stroke:"#2a2a2a",strokeOpacity:.5}),(0,s.jsx)(v.W,{dataKey:"timestamp",tickFormatter:e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),stroke:"#9ca3af",fontSize:12,tickLine:!1,axisLine:!1,interval:"preserveStartEnd"}),(0,s.jsx)(N.h,{stroke:"#9ca3af",fontSize:12,tickLine:!1,axisLine:!1,domain:["dataMin - 2","dataMax + 2"]}),(0,s.jsx)(y.m,{content:(0,s.jsx)(e=>{let{active:t,payload:a,label:l}=e;if(t&&a&&a.length){let e=a[0].payload;return(0,s.jsxs)("div",{className:"bg-gray-800 border border-[#29E7CD] rounded-xl p-3 shadow-lg",children:[(0,s.jsxs)("p",{className:"text-white font-medium text-sm",children:[e.date," at ",e.time]}),(0,s.jsxs)("p",{className:"text-[#29E7CD] font-semibold text-lg",children:[e.temperature,"\xb0C"]})]})}return null},{})}),null!==a.min_temp_celsius&&(0,s.jsx)(b.e,{y:a.min_temp_celsius,stroke:"#ef4444",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Min: ".concat(a.min_temp_celsius,"\xb0C"),position:"insideTopLeft",style:{fill:"#ef4444",fontSize:"12px"}}}),null!==a.max_temp_celsius&&(0,s.jsx)(b.e,{y:a.max_temp_celsius,stroke:"#ef4444",strokeDasharray:"5 5",strokeWidth:2,label:{value:"Max: ".concat(a.max_temp_celsius,"\xb0C"),position:"insideTopRight",style:{fill:"#ef4444",fontSize:"12px"}}}),(0,s.jsx)(h.N,{type:"monotone",dataKey:"temperature",stroke:"#29E7CD",strokeWidth:3,dot:{fill:"#29E7CD",stroke:"#ffffff",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#29E7CD",strokeWidth:2,fill:"#ffffff"},animationDuration:1e3,animationEasing:"ease-in-out"})]})})}):(0,s.jsxs)("div",{className:"w-full h-96 bg-gray-800 rounded-lg flex items-center justify-center relative overflow-hidden",children:[(0,s.jsxs)("div",{className:"absolute inset-0",children:[(0,s.jsx)("div",{className:"absolute inset-0 opacity-20",children:(0,s.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-transparent via-gray-600 to-transparent animate-pulse"})}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-3/4 h-1 bg-gradient-to-r from-transparent via-[#29E7CD] to-transparent rounded-full animate-pulse"})}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"flex space-x-2",children:[0,1,2,3,4].map(e=>(0,s.jsx)("div",{className:"w-2 h-2 bg-[#29E7CD] rounded-full animate-pulse",style:{animationDelay:"".concat(.2*e,"s"),animationDuration:"1.5s"}},e))})})]}),(0,s.jsx)("div",{className:"text-gray-400 text-sm font-medium relative z-10",children:"Drawing temperature path..."})]})}function _(e){let{logs:t,equipment:a,timeFilter:r}=e,n=(0,l.useRef)(null),[i,o]=(0,l.useState)(!1),c=(()=>{let e=t;if(a&&a.name&&(e=t.filter(e=>e.location===a.name)),console.log("\uD83D\uDD0D Filter Debug:",{totalLogs:t.length,equipmentName:null==a?void 0:a.name,equipmentFilteredCount:e.length,timeFilter:r,sampleEquipmentLogs:e.slice(0,3)}),console.log("\uD83D\uDD0D Filter Debug - Expanded:","Total logs:",t.length,"Equipment name:",null==a?void 0:a.name,"Equipment filtered count:",e.length,"Time filter:",r,"Sample logs:",e.slice(0,3)),1==[...new Set(e.map(e=>e.log_date))].length&&e.length>0)return e;let s=new Date,l=new Date;switch(r){case"24h":if(e.length>0){let t=e.reduce((e,t)=>new Date("".concat(t.log_date," ").concat(t.log_time))>new Date("".concat(e.log_date," ").concat(e.log_time))?t:e),a=new Date("".concat(t.log_date," ").concat(t.log_time));l.setTime(a.getTime()-864e5)}else l.setHours(s.getHours()-24);break;case"7d":if(e.length>0){let t=e.reduce((e,t)=>new Date("".concat(t.log_date," ").concat(t.log_time))>new Date("".concat(e.log_date," ").concat(e.log_time))?t:e),a=new Date("".concat(t.log_date," ").concat(t.log_time));l.setTime(a.getTime()-6048e5)}else l.setDate(s.getDate()-7);break;case"30d":if(e.length>0){let t=e.reduce((e,t)=>new Date("".concat(t.log_date," ").concat(t.log_time))>new Date("".concat(e.log_date," ").concat(e.log_time))?t:e),a=new Date("".concat(t.log_date," ").concat(t.log_time));l.setTime(a.getTime()-2592e6)}else l.setDate(s.getDate()-30);break;default:return e}return e.filter(e=>new Date("".concat(e.log_date," ").concat(e.log_time))>=l)})(),d=c.map(e=>{let t="".concat(e.log_date," ").concat(e.log_time),a=new Date(t).getTime();return{timestamp:t,timestampMs:a,temperature:e.temperature_celsius,date:e.log_date,time:e.log_time}}).sort((e,t)=>e.timestampMs-t.timestampMs);console.log("\uD83D\uDD0D Chart Data Structure:",{chartDataLength:d.length,sampleChartData:d.slice(0,3),timestampFormat:d.length>0?d[0].timestamp:"N/A",temperatureValues:d.slice(0,3).map(e=>e.temperature)}),console.log("\uD83D\uDD0D Chart Data Structure - Expanded:","Chart data length:",d.length,"Sample chart data:",d.slice(0,3),"Timestamp format:",d.length>0?d[0].timestamp:"N/A","Temperature values:",d.slice(0,3).map(e=>e.temperature)),(0,l.useEffect)(()=>{c.length>0&&a&&a.name?o(!0):o(!1)},[c.length,null==a?void 0:a.name,r]);let m=e=>null===a.min_temp_celsius||null===a.max_temp_celsius||e>=a.min_temp_celsius&&e<=a.max_temp_celsius,u=(()=>{let e=d.length;return{shouldSample:e>1e3,sampleRate:e>5e3?5:e>2e3?3:1,chartHeight:e>500?200:e>100?250:300,dotSize:e>1e3?2:e>500?3:4,showDots:e<200,lineWidth:e>1e3?1:e>500?2:3,xAxisInterval:e<20?0:e<50?1:e<100?2:e<200?3:e<500?4:e<1e3?5:6}})(),x=(()=>{if(!u.shouldSample)return d;let e=[];for(let t=0;t<d.length;t+=u.sampleRate)e.push(d[t]);return d.length>0&&e[e.length-1]!==d[d.length-1]&&e.push(d[d.length-1]),e})(),g=x.map((e,t)=>({...e,isOutOfRange:!m(e.temperature),isRecentOutOfRange:!m(e.temperature)&&t>=x.length-5}));console.log("\uD83D\uDD0D Chart Debug Info:",{equipmentName:null==a?void 0:a.name,filteredLogsCount:c.length,chartDataCount:d.length,optimizedDataCount:x.length,enhancedDataCount:g.length,sampleData:g.slice(0,3),timeFilter:r,isLoaded:i}),console.log("\uD83D\uDD0D Chart Debug Info - Expanded:","Equipment name:",null==a?void 0:a.name,"Filtered logs count:",c.length,"Chart data count:",d.length,"Optimized data count:",x.length,"Enhanced data count:",g.length,"Sample enhanced data:",g.slice(0,3),"Time filter:",r,"Is loaded:",i);let p=c.length>0?c[c.length-1]:null,h=null==p?void 0:p.temperature_celsius,f=null!=h?m(h)?"In Range":"Out of Range":"N/A",b="In Range"===f?"text-green-400":"text-red-400",j=g.some(e=>e.isRecentOutOfRange),y=(()=>{let e=new Date().toISOString().split("T")[0],t=c.filter(t=>t.log_date===e);return{hasMinimumLogs:t.length>=2,logCount:t.length,hasFoodTemp:t.some(e=>"food"===e.temperature_type||"Food"===e.temperature_type),lastLogTime:t.length>0?t[t.length-1].log_time:null}})(),v=(()=>{let e=[],t=new Date(new Date().getTime()-144e5);return 0===c.filter(e=>new Date("".concat(e.log_date," ").concat(e.log_time))>=t).length&&c.length>0&&e.push({type:"warning",message:"No logs in last 4 hours",icon:"⏰"}),e})();return((0,l.useEffect)(()=>{let e=()=>{},t=()=>{};return document.addEventListener("mouseup",e),document.addEventListener("touchend",t),()=>{document.removeEventListener("mouseup",e),document.removeEventListener("touchend",t)}},[]),d&&0!==d.length)?i&&0!==d.length&&a&&a.name?(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a] temperature-chart-container",ref:n,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white chart-title",children:a.name}),j&&(0,s.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(b.replace("text-","bg-"))}),(0,s.jsx)("span",{className:"text-sm ".concat(b),children:f})]})]}),(0,s.jsx)("div",{className:"text-2xl font-bold text-white mb-2",children:h?"".concat(h.toFixed(1),"\xb0C"):"--"}),(0,s.jsxs)("div",{className:"text-xs text-gray-400 mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{children:[x.length," of ",d.length," readings",u.shouldSample&&(0,s.jsx)("span",{className:"ml-2 text-yellow-400",children:"(sampled for performance)"})]}),(0,s.jsxs)("span",{className:"text-[#29E7CD]",children:[r.toUpperCase()," view"]})]}),(0,s.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1 ".concat(y.hasMinimumLogs?"text-green-400":"text-red-400"),children:[(0,s.jsx)("span",{children:y.hasMinimumLogs?"✅":"❌"}),(0,s.jsxs)("span",{children:[y.logCount,"/2+ logs today"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 ".concat(y.hasFoodTemp?"text-green-400":"text-yellow-400"),children:[(0,s.jsx)("span",{children:y.hasFoodTemp?"✅":"\uD83D\uDCCB"}),(0,s.jsx)("span",{children:y.hasFoodTemp?"Food temped":"No food temp"})]})]}),y.lastLogTime&&(0,s.jsxs)("span",{className:"text-gray-500",children:["Last: ",y.lastLogTime]})]}),v.length>0&&(0,s.jsx)("div",{className:"mt-2 space-y-1",children:v.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-2 px-2 py-1 rounded text-xs ".concat("critical"===e.type?"bg-red-500/10 text-red-400 border border-red-500/20":"warning"===e.type?"bg-yellow-500/10 text-yellow-400 border border-yellow-500/20":"bg-blue-500/10 text-blue-400 border border-blue-500/20"),children:[(0,s.jsx)("span",{children:e.icon}),(0,s.jsx)("span",{children:e.message})]},t))})]}),(0,s.jsx)("div",{className:"w-full",style:{height:"".concat(u.chartHeight,"px")},children:(0,s.jsx)(w,{logs:t,equipment:a,timeFilter:r})})]}):(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a]",children:[(0,s.jsx)("div",{className:"h-6 bg-[#2a2a2a] rounded w-1/3 mb-4"}),(0,s.jsx)("div",{className:"h-8 bg-[#2a2a2a] rounded w-1/4 mb-4"}),(0,s.jsx)("div",{className:"h-48 bg-[#2a2a2a] rounded"})]}):(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:a.name}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(b.replace("text-","bg-"))}),(0,s.jsx)("span",{className:"text-sm ".concat(b),children:f})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-[#29E7CD]/20 to-[#D925C7]/20 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,s.jsx)("h4",{className:"text-lg font-medium text-white mb-2",children:"No Temperature Data"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm max-w-sm",children:"No temperature logs found for this equipment."})]})]})}var D=a(19215),C=a(12104);function E(e){let{allLogs:t,equipment:a}=e,{t:n}=(0,r.Bd)(),[i,o]=(0,l.useState)("24h"),[c,d]=(0,l.useState)(0),[m,u]=(0,l.useState)(!1),[x,g]=(0,l.useState)(null),[p,h]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(a.length>0&&t.length>0){if(u(!0),!x&&a.length>0){let e=y();e?g(e.id):g(a[0].id)}if(!p){let e=j();e!==i&&o(e)}}},[a.length,t.length,c,x,p]);let f=e=>{let a=t.filter(t=>t.location===e.name),s=new Date;if(s.setDate(s.getDate()-c),(0,D.GP)(s,"yyyy-MM-dd"),"24h"===i){let e=new Date,t=new Date(e.getTime()-864e5);a=a.filter(a=>{let s=new Date("".concat(a.log_date,"T").concat(a.log_time));return s>=t&&s<=e})}else if("7d"===i){let e=new Date(s);e.setDate(s.getDate()-7),a=a.filter(t=>new Date(t.log_date)>=e)}else if("30d"===i){let e=new Date(s);e.setDate(s.getDate()-30),a=a.filter(t=>new Date(t.log_date)>=e)}return a},b=e=>{let a=new Date;a.setDate(a.getDate()-c),(0,D.GP)(a,"yyyy-MM-dd");let s=t;if("24h"===e){let e=new Date,a=new Date(e.getTime()-864e5);s=t.filter(t=>{let s=new Date("".concat(t.log_date,"T").concat(t.log_time));return s>=a&&s<=e})}else if("7d"===e){let e=new Date(a);e.setDate(a.getDate()-7),s=t.filter(t=>new Date(t.log_date)>=e)}else if("30d"===e){let e=new Date(a);e.setDate(a.getDate()-30),s=t.filter(t=>new Date(t.log_date)>=e)}return s.length>0},j=()=>{for(let e of["24h","7d","30d","all"])if(b(e))return e;return"24h"},y=()=>a.find(e=>"out-of-range"===v(e).status),v=e=>{let t=f(e);if(0===t.length)return{status:"no-data",color:"text-gray-400"};let a=t[t.length-1].temperature_celsius;if(null===e.min_temp_celsius||null===e.max_temp_celsius)return{status:"no-thresholds",color:"text-blue-400"};let s=a>=e.min_temp_celsius&&a<=e.max_temp_celsius;return{status:s?"in-range":"out-of-range",color:s?"text-green-400":"text-red-400",temperature:a}};return m?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-[#1f1f1f] p-4 rounded-2xl shadow-lg border border-[#2a2a2a] flex flex-wrap gap-2",children:m?["24h","7d","30d","all"].map(e=>(0,s.jsx)("button",{onClick:()=>{o(e),h(!0)},className:"px-4 py-2 rounded-xl text-sm font-medium transition-colors ".concat(i===e?"bg-[#29E7CD] text-black":"bg-transparent text-gray-400 hover:text-white hover:bg-[#2a2a2a]"),children:n("timeFilter.".concat(e),"24h"===e?"Last 24h":"7d"===e?"Last 7 Days":"30d"===e?"Last 30 Days":"All Time")},e)):(0,s.jsx)(C.O0,{variant:"button",count:4})}),(0,s.jsx)("div",{className:"grid gap-3 ".concat(a.length<=2?"grid-cols-1 sm:grid-cols-2":a.length<=4?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4":a.length<=6?"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6":a.length<=12?"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6":"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6"),children:m?a.map(e=>{let t=v(e),l=f(e),r="out-of-range"===t.status,n="no-thresholds"===t.status,o=x===e.id,c=a.length>6;return(0,s.jsxs)("button",{onClick:()=>g(e.id),className:"group bg-[#1f1f1f] rounded-xl shadow-lg border transition-all duration-300 hover:shadow-xl hover:-translate-y-0.5 text-left w-full ".concat(c?"p-3":"p-4"," ").concat(o?"border-[#29E7CD] ring-2 ring-[#29E7CD]/20 bg-[#29E7CD]/5":r?"border-red-500/50 hover:border-red-500":n?"border-yellow-500/50 hover:border-yellow-500":"border-[#2a2a2a] hover:border-[#29E7CD]/50"),children:[(0,s.jsx)("div",{className:"flex items-center justify-between ".concat(c?"mb-2":"mb-3"),children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-semibold text-white truncate group-hover:text-[#29E7CD] transition-colors ".concat(c?"text-xs":"text-sm"),children:e.name}),(0,s.jsxs)("div",{className:"flex items-center space-x-1.5 mt-0.5",children:[(0,s.jsx)("div",{className:"rounded-full ".concat(c?"w-1 h-1":"w-1.5 h-1.5"," ").concat(r?"bg-red-500":n?"bg-yellow-500":"bg-green-500")}),(0,s.jsx)("span",{className:"font-medium ".concat("text-xs"," ").concat(r?"text-red-400":n?"text-yellow-400":"text-green-400"),children:"no-data"===t.status?"No Data":"no-thresholds"===t.status?"Setup Required":"in-range"===t.status?"In Range":"Out of Range"})]})]})}),(0,s.jsxs)("div",{className:c?"mb-2":"mb-3",children:[(0,s.jsx)("div",{className:"font-bold text-white ".concat(c?"text-lg mb-1":"text-2xl mb-1"),children:t.temperature?"".concat(t.temperature.toFixed(1),"\xb0C"):"--"}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[l.length," readings ",c?"":"• ".concat(i.toUpperCase())]})]}),!c&&(r||n)&&(0,s.jsxs)("div",{className:"pt-3 border-t border-[#2a2a2a]",children:[r&&(0,s.jsxs)("div",{className:"flex items-center space-x-1.5 text-red-400 text-xs",children:[(0,s.jsx)("span",{children:"⚠️"}),(0,s.jsx)("span",{children:"Attention required"})]}),n&&(0,s.jsxs)("div",{className:"flex items-center space-x-1.5 text-yellow-400 text-xs",children:[(0,s.jsx)("span",{children:"⚙️"}),(0,s.jsx)("span",{children:"Configure thresholds"})]})]}),c&&r&&(0,s.jsx)("div",{className:"flex items-center justify-center text-red-400 text-xs",children:(0,s.jsx)("span",{children:"⚠️"})})]},e.id)}):(0,s.jsx)(C.O0,{variant:"card",count:6,height:"80px"})}),m?0===a.length?(0,s.jsx)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a] w-full h-64 flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-gray-400",children:"No equipment found to display analytics."})}):x?(0,s.jsx)("div",{className:"chart-container",children:(()=>{let e=a.find(e=>e.id===x)||null;return e?(0,s.jsx)(_,{logs:f(e),equipment:e,timeFilter:i},e.id):null})()}):(0,s.jsx)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a] w-full h-64 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCCA"}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:"Select an equipment to view its temperature chart"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Click on any equipment card above to see detailed analytics"})]})}):(0,s.jsx)(C.O0,{variant:"chart",height:"320px"})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-[#1f1f1f] p-4 rounded-2xl shadow-lg border border-[#2a2a2a] flex flex-wrap gap-2",children:["24h","7d","30d","all"].map(e=>(0,s.jsx)("div",{className:"px-4 py-2 rounded-xl bg-gray-700 w-20 h-8"},e))}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-3",children:(0,s.jsx)(C.O0,{variant:"card",count:6,height:"80px"})}),(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsx)(C.O0,{variant:"chart",count:3,height:"320px"})})]})}var T=a(85040);function k(){let{t:e}=(0,r.Bd)(),{formatDate:t}=o(),[a,n]=(0,l.useState)([]),[i,c]=(0,l.useState)([]),[d,m]=(0,l.useState)([]),[x,p]=(0,l.useState)(!1),[h,f]=(0,l.useState)(!1),[b,j]=(0,l.useState)("analytics"),[y,v]=(0,l.useState)({}),[N,w]=(0,l.useState)(""),[_,D]=(0,l.useState)("all"),[C,k]=(0,l.useState)({log_date:"",log_time:"",temperature_type:"fridge",temperature_celsius:"",location:"",notes:"",logged_by:""}),[S,q]=(0,l.useState)(!1);(0,T.R)({allLogs:i,equipment:d});let L=async()=>{try{let e="/api/temperature-logs",t=new URLSearchParams;N&&t.append("date",N),"all"!==_&&t.append("type",_),t.toString()&&(e+="?".concat(t.toString()));let a=await fetch(e),s=await a.json();if(s.success){if(0===s.data.length&&i.length>0){let e=[...new Set(i.map(e=>e.log_date))].sort().reverse();if(e.length>0){let t=e[0];console.log("No data for ".concat(N,", switching to ").concat(t)),w(t);let a="/api/temperature-logs?date=".concat(t).concat("all"!==_?"&type=".concat(_):""),s=await fetch(a),l=await s.json();l.success&&n(l.data);return}}n(s.data)}}catch(e){console.error("fetchLogs - Error:",e)}},F=async()=>{try{let e=await fetch("/api/temperature-logs"),t=await e.json();console.log("fetchAllLogs - API response:",t),t.success&&t.data&&(console.log("fetchAllLogs - Setting allLogs:",t.data.length,"logs"),c(t.data))}catch(e){console.error("fetchAllLogs - Error:",e)}},O=async()=>{try{let e=await fetch("/api/temperature-equipment"),t=await e.json();console.log("fetchEquipment - API response:",t),t.success&&(console.log("fetchEquipment - Setting equipment:",t.data.length,"equipment"),m(t.data))}catch(e){console.error("fetchEquipment - Error:",e)}};(0,l.useEffect)(()=>{let e=new Date;w(e.toISOString().split("T")[0]),k(t=>({...t,log_date:e.toISOString().split("T")[0],log_time:e.toTimeString().split(" ")[0].substring(0,5)}))},[]),(0,l.useEffect)(()=>{if(i.length>0&&!h){let e=[...new Set(i.map(e=>e.log_date))].sort().reverse();e.length>0&&(w(e[0]),f(!0))}},[i,h]),(0,l.useEffect)(()=>{(async()=>{try{p(!0),await Promise.all([L(),O(),F()])}catch(e){console.error("Error loading temperature data:",e)}finally{p(!1)}})()},[]),(0,l.useEffect)(()=>{N&&L()},[N,_]);let A=async e=>{e.preventDefault();try{let e=await fetch("/api/temperature-logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...C,temperature_celsius:parseFloat(C.temperature_celsius)})});(await e.json()).success&&(k({log_date:new Date().toISOString().split("T")[0],log_time:new Date().toTimeString().split(" ")[0].substring(0,5),temperature_type:"fridge",temperature_celsius:"",location:"",notes:"",logged_by:""}),q(!1),L(),F())}catch(e){}},M=async(e,t,a)=>{v(t=>({...t,[e]:!0}));try{let e=await fetch("/api/temperature-logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log_date:new Date().toISOString().split("T")[0],log_time:new Date().toTimeString().split(" ")[0].substring(0,5),temperature_type:a,temperature_celsius:0,location:t,notes:"Quick log",logged_by:"System"})});(await e.json()).success&&(L(),F())}catch(e){alert("Failed to log temperature. Please try again.")}finally{v(t=>({...t,[e]:!1}))}},I=async(e,t)=>{try{let a=await fetch("/api/temperature-equipment/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});(await a.json()).success&&O()}catch(e){}},R=async(e,t,a,s,l)=>{try{let r=await fetch("/api/temperature-equipment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,equipment_type:t,location:a,min_temp_celsius:s,max_temp_celsius:l,is_active:!0})});(await r.json()).success&&O()}catch(e){}},z=async e=>{try{let t=await fetch("/api/temperature-equipment/".concat(e),{method:"DELETE"});(await t.json()).success&&O()}catch(e){}};return 0===d.length?(0,s.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-4 sm:p-6",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto"})}):(0,s.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-4 sm:p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-white mb-2",children:["\uD83C\uDF21️ ",e("temperature.title","Temperature Logs")]}),(0,s.jsx)("p",{className:"text-gray-400",children:e("temperature.subtitle","Track fridge, freezer, and food temperatures for food safety compliance")})]}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex space-x-1 bg-[#1f1f1f] p-1 rounded-2xl border border-[#2a2a2a]",children:[(0,s.jsxs)("button",{onClick:()=>j("logs"),className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:ring-offset-2 focus:ring-offset-[#0a0a0a] ".concat("logs"===b?"bg-[#29E7CD] text-black shadow-lg":"text-gray-400 hover:text-white"),"aria-pressed":"logs"===b,"aria-label":"View temperature logs",children:["\uD83D\uDCDD ",e("temperature.logs","Logs")]}),(0,s.jsxs)("button",{onClick:()=>j("equipment"),className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:ring-offset-2 focus:ring-offset-[#0a0a0a] ".concat("equipment"===b?"bg-[#29E7CD] text-black shadow-lg":"text-gray-400 hover:text-white"),"aria-pressed":"equipment"===b,"aria-label":"View temperature equipment",children:["\uD83C\uDFED ",e("temperature.equipment","Equipment")]}),(0,s.jsxs)("button",{onClick:()=>j("analytics"),className:"px-6 py-3 rounded-xl font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:ring-offset-2 focus:ring-offset-[#0a0a0a] ".concat("analytics"===b?"bg-[#29E7CD] text-black shadow-lg":"text-gray-400 hover:text-white"),"aria-pressed":"analytics"===b,"aria-label":"View temperature analytics",children:["\uD83D\uDCCA ",e("temperature.analytics","Analytics")]})]})}),"logs"===b&&(0,s.jsx)(u,{logs:a,equipment:d,selectedDate:N,setSelectedDate:w,selectedType:_,setSelectedType:D,showAddLog:S,setShowAddLog:q,newLog:C,setNewLog:k,onAddLog:A,onRefreshLogs:L}),"equipment"===b&&(0,s.jsx)(g,{equipment:d,quickTempLoading:y,onUpdateEquipment:I,onCreateEquipment:R,onDeleteEquipment:z,onQuickTempLog:M}),"analytics"===b&&(0,s.jsx)(E,{allLogs:i,equipment:d})]})})}function S(){return(0,s.jsx)(c.tH,{children:(0,s.jsx)(k,{})})}}},e=>{e.O(0,[2507,563,8650,8405,9420,622,7979,1899,4450,9324,8585,9592,433,2652,3494,2574,9173,3023,1356,309,4191,2834,957,6691,1151,9473,9219,6053,3376,2076,7358],()=>e(e.s=41032)),_N_E=e.O()}]);