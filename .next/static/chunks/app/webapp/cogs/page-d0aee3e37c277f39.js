(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9247],{42142:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(95155),i=s(12115),n=s(50160),a=s(12104),l=s(4929),o=s(54224);let d=e=>{let{formData:t,recipes:s,selectedRecipe:i,onDishNameChange:n,onDishPortionsChange:a,onRecipeSelect:l}=e,{dishName:d,dishPortions:c,dishNameLocked:u,recipeExists:x,checkingRecipe:m}=t;return(0,r.jsxs)("div",{className:"bg-[#1f1f1f] p-4 sm:p-6 rounded-lg shadow",children:[(0,r.jsx)("h2",{className:"text-lg sm:text-xl font-semibold mb-6",children:"Create Dish"}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83C\uDF7D️ Dish Name"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",placeholder:"Enter dish name (e.g., Chicken Curry)",value:d,onChange:e=>n((0,o.xQ)(e.target.value)),disabled:u,className:"w-full px-4 py-3 border rounded-xl focus:outline-none focus:ring-2 transition-all duration-200 shadow-sm hover:shadow-md ".concat(u?"border-blue-400 bg-[#1a1a1a] text-gray-300 cursor-not-allowed":!0===x?"border-orange-400 bg-[#0a0a0a] text-white focus:ring-orange-400 focus:border-orange-400":!1===x?"border-green-400 bg-[#0a0a0a] text-white focus:ring-green-400 focus:border-green-400":"border-[#2a2a2a] bg-[#0a0a0a] text-white focus:ring-[#29E7CD] focus:border-[#29E7CD]")}),u&&(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),d.trim()&&(0,r.jsx)("div",{className:"mt-2 flex items-center space-x-2",children:m?(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-gray-400",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{className:"text-sm",children:"Checking..."})]}):!0===x?(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-orange-400",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"⚠️ Recipe exists - ingredients loaded, will update existing recipe"})]}):!1===x?(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-green-400",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"✅ New recipe - will create new recipe"})]}):null}),u&&(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-2 text-blue-400",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"\uD83D\uDD12 Dish name locked - editing ingredients"})]})]}),(0,r.jsx)("div",{className:"mb-6 pt-4 border-t border-[#2a2a2a]/50",children:(0,r.jsxs)("div",{className:"bg-gradient-to-r from-[#D925C7]/10 to-[#29E7CD]/10 border border-[#D925C7]/30 p-4 rounded-2xl",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-white mb-1",children:"\uD83D\uDCDA Or Select Existing Recipe"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Choose a recipe to load ingredients automatically"})]}),(0,r.jsxs)("select",{value:i,onChange:e=>l(e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-[#D925C7] focus:border-[#D925C7] transition-all duration-200 shadow-sm hover:shadow-md",children:[(0,r.jsx)("option",{value:"",children:"Create new dish from scratch..."}),s.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]})}),(0,r.jsxs)("div",{className:"pt-4 border-t border-[#2a2a2a]/50",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83C\uDF7D️ Number of Portions"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"number",min:"1",placeholder:"1",value:c,onChange:e=>a(Number(e.target.value)),className:"w-24 px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-[#29E7CD] transition-all duration-200 shadow-sm hover:shadow-md text-center font-semibold"}),(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"portions"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"This determines the cost per portion for your pricing calculations"})]})]})},c=e=>{let{showAddIngredient:t,ingredients:s,ingredientSearch:i,showSuggestions:n,filteredIngredients:a,selectedIngredient:l,newIngredient:o,onToggleAddIngredient:d,onSearchChange:c,onIngredientSelect:u,onQuantityChange:x,onUnitChange:m,onAddIngredient:g}=e;return(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"bg-gradient-to-r from-[#29E7CD]/10 to-[#D925C7]/10 border border-[#29E7CD]/30 p-4 rounded-2xl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-white mb-1",children:"\uD83E\uDD58 Add Ingredients"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Add ingredients manually to build your dish"}),(0,r.jsx)("p",{className:"text-xs text-[#29E7CD] mt-1",children:"✨ Automatic unit conversion: Use any unit (tsp, tbsp, cups, ml, g, kg) - we'll convert to the ingredient's base unit!"})]}),(0,r.jsxs)("button",{onClick:d,className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white px-6 py-3 rounded-xl text-sm font-medium hover:from-[#29E7CD]/80 hover:to-[#D925C7]/80 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,r.jsx)("span",{children:t?"Cancel":"Add Ingredient"})]})]}),t&&(0,r.jsxs)("form",{onSubmit:g,className:"space-y-3 p-4 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg",children:[(0,r.jsxs)("div",{className:"relative ingredient-search-container",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83D\uDD0D Search & Select Ingredient"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",placeholder:"Type to search ingredients...",value:i,onChange:e=>c(e.target.value),onFocus:()=>c(i),className:"w-full max-w-md pl-10 pr-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-[#29E7CD] transition-all duration-200 shadow-sm hover:shadow-md"}),(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i&&(0,r.jsx)("button",{type:"button",onClick:()=>c(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white transition-colors",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i&&(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-400",children:[a.length," ingredient",1!==a.length?"s":""," found"]})]}),n&&a.length>0&&(0,r.jsx)("div",{className:"absolute z-10 w-full max-w-md mt-1 bg-[#1f1f1f] border border-[#2a2a2a] rounded-xl shadow-lg max-h-60 overflow-y-auto suggestions-dropdown",children:a.slice(0,10).map(e=>{let t=e.cost_per_unit_incl_trim||e.cost_per_unit||0;return(0,r.jsx)("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),u(e)},className:"w-full px-4 py-3 text-left hover:bg-[#2a2a2a] transition-colors border-b border-[#2a2a2a] last:border-b-0",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-white font-medium",children:e.ingredient_name}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:[e.unit&&"".concat(e.unit," • "),"$",t.toFixed(2),"/",e.unit||"unit"]})]}),(0,r.jsx)("div",{className:"text-[#29E7CD] text-sm",children:e.trim_peel_waste_percentage?"".concat(e.trim_peel_waste_percentage,"% waste"):"No waste"})]})},e.id)})}),n&&0===a.length&&i&&(0,r.jsxs)("div",{className:"absolute z-10 w-full mt-1 p-3 bg-[#1f1f1f] border border-[#2a2a2a] rounded-xl shadow-lg",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-400 text-center",children:['\uD83D\uDD0D No ingredients found matching "',i,'"']}),(0,r.jsx)("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Try a different search term or add the ingredient to your list first"})]}),l&&(0,r.jsx)("div",{className:"mt-2 p-3 bg-[#29E7CD]/10 border border-[#29E7CD]/20 rounded-lg",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-[#29E7CD] font-medium",children:["✓ ",l.ingredient_name]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:["$",(l.cost_per_unit_incl_trim||l.cost_per_unit||0).toFixed(2),"/",l.unit||"unit"]})]}),(0,r.jsx)("button",{type:"button",onClick:()=>c(""),className:"text-gray-400 hover:text-white transition-colors",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"⚖️ Quantity"}),(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",required:!0,value:o.quantity||0,onChange:e=>x(parseFloat(e.target.value)||0),onFocus:e=>{0===(o.quantity||0)&&e.target.select()},className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-[#29E7CD] transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"0.00"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83D\uDCCF Unit"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{value:o.unit||"kg",onChange:e=>m(e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-[#29E7CD] transition-all duration-200 shadow-sm hover:shadow-md appearance-none cursor-pointer",children:[(0,r.jsx)("option",{value:"kg",children:"kg"}),(0,r.jsx)("option",{value:"g",children:"g"}),(0,r.jsx)("option",{value:"L",children:"L"}),(0,r.jsx)("option",{value:"mL",children:"mL"}),(0,r.jsx)("option",{value:"pcs",children:"pcs"}),(0,r.jsx)("option",{value:"box",children:"box"}),(0,r.jsx)("option",{value:"GM",children:"GM"}),(0,r.jsx)("option",{value:"PC",children:"PC"}),(0,r.jsx)("option",{value:"PACK",children:"PACK"}),(0,r.jsx)("option",{value:"BAG",children:"BAG"})]}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]}),(0,r.jsxs)("button",{type:"submit",className:"w-full bg-gradient-to-r from-[#29E7CD] to-[#3B82F6] text-white px-6 py-3 rounded-xl hover:from-[#29E7CD]/80 hover:to-[#3B82F6]/80 transition-all duration-200 shadow-lg hover:shadow-xl font-medium flex items-center justify-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,r.jsx)("span",{children:"Add Ingredient to Dish"})]})]})]})})},u=e=>{let{calculations:t,editingIngredient:s,editQuantity:i,onEditIngredient:n,onSaveEdit:a,onCancelEdit:l,onRemoveIngredient:o,onEditQuantityChange:d,totalCOGS:c,costPerPortion:u,dishPortions:x}=e;return 0===t.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No ingredients added yet. Add some ingredients to see COGS calculations."}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"block md:hidden",children:(0,r.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"p-3 bg-[#2a2a2a] rounded-lg border border-[#3a3a3a]",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-white",children:e.ingredientName}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("span",{className:"text-sm font-bold text-[#29E7CD]",children:["$",e.yieldAdjustedCost.toFixed(2)]}),(0,r.jsx)("button",{onClick:()=>n(e.ingredientId,e.quantity),className:"p-1 text-gray-400 hover:text-[#29E7CD] transition-colors duration-200",title:"Edit quantity",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,r.jsx)("button",{onClick:()=>o(e.ingredientId),className:"p-1 text-gray-400 hover:text-red-400 transition-colors duration-200",title:"Remove ingredient",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),s===e.ingredientId?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"number",value:i,onChange:e=>d(parseFloat(e.target.value)||0),className:"w-20 px-2 py-1 text-sm border border-[#3a3a3a] bg-[#0a0a0a] text-white rounded focus:outline-none focus:ring-1 focus:ring-[#29E7CD]",step:"0.1",min:"0"}),(0,r.jsx)("span",{className:"text-xs text-gray-400",children:e.unit})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:a,className:"px-3 py-1 text-xs bg-[#29E7CD] text-white rounded hover:bg-[#29E7CD]/80 transition-colors duration-200",children:"Save"}),(0,r.jsx)("button",{onClick:l,className:"px-3 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-500 transition-colors duration-200",children:"Cancel"})]})]}):(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:[e.quantity," ",e.unit]})]},t))})}),(0,r.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ingredient"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Cost"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-[#1f1f1f] divide-y divide-gray-200",children:t.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-[#2a2a2a]/50 transition-colors duration-200",children:[(0,r.jsx)("td",{className:"px-3 py-2 text-sm text-white",children:e.ingredientName}),(0,r.jsx)("td",{className:"px-3 py-2 text-sm text-gray-500",children:s===e.ingredientId?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"number",value:i,onChange:e=>d(parseFloat(e.target.value)||0),className:"w-20 px-2 py-1 text-sm border border-[#3a3a3a] bg-[#0a0a0a] text-white rounded focus:outline-none focus:ring-1 focus:ring-[#29E7CD]",step:"0.1",min:"0"}),(0,r.jsx)("span",{className:"text-xs text-gray-400",children:e.unit})]}):(0,r.jsxs)("span",{children:[e.quantity," ",e.unit]})}),(0,r.jsxs)("td",{className:"px-3 py-2 text-sm text-gray-500",children:["$",e.yieldAdjustedCost.toFixed(2)]}),(0,r.jsx)("td",{className:"px-3 py-2 text-sm",children:(0,r.jsx)("div",{className:"flex items-center space-x-2",children:s===e.ingredientId?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:a,className:"px-2 py-1 text-xs bg-[#29E7CD] text-white rounded hover:bg-[#29E7CD]/80 transition-colors duration-200",children:"Save"}),(0,r.jsx)("button",{onClick:l,className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-500 transition-colors duration-200",children:"Cancel"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>n(e.ingredientId,e.quantity),className:"p-1 text-gray-400 hover:text-[#29E7CD] transition-colors duration-200",title:"Edit quantity",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,r.jsx)("button",{onClick:()=>o(e.ingredientId),className:"p-1 text-gray-400 hover:text-red-400 transition-colors duration-200",title:"Remove ingredient",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})})]},t))})]})}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("span",{className:"text-lg font-medium text-white",children:"Total COGS:"}),(0,r.jsxs)("span",{className:"text-lg font-bold text-[#29E7CD]",children:["$",c.toFixed(2)]})]}),x>0&&(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"Cost per portion:"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-white",children:["$",u.toFixed(2)]})]})]})]})},x=e=>{let{costPerPortion:t,targetGrossProfit:s,pricingStrategy:i,pricingCalculation:n,onTargetGrossProfitChange:a,onPricingStrategyChange:l}=e;return t<=0||!n?null:(0,r.jsx)("div",{className:"mt-6 pt-4 border-t border-[#2a2a2a]",children:(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:["\uD83D\uDCB0 Costing Tool",(0,r.jsx)("div",{className:"ml-2 w-2 h-2 bg-[#29E7CD] rounded-full animate-pulse"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83C\uDFAF Target Gross Profit %"}),(0,r.jsx)("div",{className:"flex space-x-2",children:[60,65,70,75,80].map(e=>(0,r.jsxs)("button",{onClick:()=>a(e),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ".concat(s===e?"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white shadow-lg":"bg-[#2a2a2a] text-gray-300 hover:bg-[#2a2a2a]/80"),children:[e,"%"]},e))})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83D\uDCCA Pricing Strategy"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,r.jsx)("button",{onClick:()=>l("charm"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ".concat("charm"===i?"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white shadow-lg":"bg-[#2a2a2a] text-gray-300 hover:bg-[#2a2a2a]/80"),children:"Charm ($19.95)"}),(0,r.jsx)("button",{onClick:()=>l("whole"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ".concat("whole"===i?"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white shadow-lg":"bg-[#2a2a2a] text-gray-300 hover:bg-[#2a2a2a]/80"),children:"Whole ($20)"}),(0,r.jsx)("button",{onClick:()=>l("real"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ".concat("real"===i?"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white shadow-lg":"bg-[#2a2a2a] text-gray-300 hover:bg-[#2a2a2a]/80"),children:"Real ($19.47)"})]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-[#29E7CD]/10 to-[#D925C7]/10 border border-[#29E7CD]/30 p-4 rounded-2xl",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-3 rounded-xl border border-[#2a2a2a]/50",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Food Cost"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-white",children:["$",t.toFixed(2)]}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"per portion"})]}),(0,r.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-3 rounded-xl border border-[#2a2a2a]/50",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Sell Price (Excl GST)"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-[#29E7CD]",children:["$",n.sellPriceExclGST.toFixed(2)]}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"for your records"})]}),(0,r.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-3 rounded-xl border border-[#2a2a2a]/50",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Menu Price (Incl GST)"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-[#D925C7]",children:["$",n.sellPriceInclGST.toFixed(2)]}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"what customer pays"})]}),(0,r.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-3 rounded-xl border border-[#2a2a2a]/50",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Gross Profit"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-green-400",children:["$",n.grossProfitDollar.toFixed(2)]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:[n.actualGrossProfit.toFixed(1),"% margin"]})]})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-[#2a2a2a]/50",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-[#D925C7]/20 to-[#29E7CD]/20 p-3 rounded-xl border border-[#D925C7]/30",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Contributing Margin"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-[#D925C7]",children:["$",n.contributingMargin.toFixed(2)]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:[n.contributingMarginPercent.toFixed(1),"% of revenue"]})]}),(0,r.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-3 rounded-xl border border-[#2a2a2a]/50",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Formula"}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:(0,r.jsx)("strong",{className:"text-[#D925C7]",children:"Revenue - Food Cost"})}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Amount available to cover fixed costs and generate profit"})]})]})}),(0,r.jsx)("div",{className:"mt-4 pt-3 border-t border-[#2a2a2a]/50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsx)("span",{className:"text-gray-400",children:"GST Amount (10%):"}),(0,r.jsxs)("span",{className:"text-white font-medium",children:["$",n.gstAmount.toFixed(2)]})]})})]})]})})},m=e=>{let{onSaveAsRecipe:t}=e;return(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-[#2a2a2a]",children:[(0,r.jsx)("button",{onClick:t,className:"w-full bg-gradient-to-r from-[#D925C7] to-[#29E7CD] text-white px-4 py-3 rounded-lg hover:from-[#D925C7]/80 hover:to-[#29E7CD]/80 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"\uD83D\uDCBE Save as Recipe in Recipe Book"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"This will save the current COGS calculation as a recipe in your Recipe Book"})]})};var g=s(67928);function h(){let{ingredients:e,recipes:t,selectedRecipe:s,calculations:l,loading:h,error:p,fetchData:f,setSelectedRecipe:b,updateCalculation:v,removeCalculation:j,addCalculation:N,checkRecipeExists:y,setError:C}=(()=>{let[e,t]=(0,i.useState)([]),[s,r]=(0,i.useState)([]),[a,l]=(0,i.useState)(""),[o,d]=(0,i.useState)([]),[c,u]=(0,i.useState)([]),[x,m]=(0,i.useState)(!1),[h,p]=(0,i.useState)(null),f=(0,i.useCallback)(async()=>{try{m(!0),p(null);let{data:e,error:s}=await g.ND.from("ingredients").select("*").order("ingredient_name"),{data:i,error:n}=await g.ND.from("recipes").select("*").order("name");s?(console.log("Ingredients table not found or empty:",s.message),t([])):(console.log("Ingredients fetched:",(null==e?void 0:e.length)||0,"items"),t(e||[])),n?(console.log("Recipes table not found or empty:",n.message),r([])):r(i||[])}catch(e){p("Failed to fetch data")}finally{m(!1)}},[]),b=(0,i.useCallback)(async e=>{if(e)try{let{data:t,error:s}=await g.ND.from("recipe_ingredients").select("*").eq("recipe_id",e);s?p(s.message):(d(t||[]),v(t||[]))}catch(e){p("Failed to fetch recipe ingredients")}},[]),v=(0,i.useCallback)(t=>{u(t.map(t=>{let s=e.find(e=>e.id===t.ingredient_id);if(!s)return null;let r=s.cost_per_unit_incl_trim||s.cost_per_unit||0,i=(0,n.mT)(r,s.unit||"g",t.unit||"g",s.ingredient_name),a=t.quantity*i,l=s.trim_peel_waste_percentage||0,o=s.yield_percentage||100,d=a;!s.cost_per_unit_incl_trim&&l>0&&(d=a/(1-l/100));let c=o/100*d;return{recipeId:t.recipe_id||"temp",ingredientId:t.ingredient_id,ingredientName:s.ingredient_name,quantity:t.quantity,unit:t.unit||s.unit||"kg",costPerUnit:i,totalCost:a,wasteAdjustedCost:d,yieldAdjustedCost:c}}).filter(Boolean))},[e]),j=(0,i.useCallback)(async e=>{try{console.log("Loading ingredients for recipe:",e);let{data:t,error:s}=await g.ND.from("recipe_ingredients").select("\n          id,\n          quantity,\n          unit,\n          ingredients (\n            id,\n            ingredient_name,\n            cost_per_unit,\n            unit,\n            trim_peel_waste_percentage,\n            yield_percentage\n          )\n        ").eq("recipe_id",e);if(s)return void console.log("Error loading recipe ingredients:",s);console.log("Loaded recipe ingredients:",t);let r=t.map(t=>{let s=t.ingredients,r=t.quantity,i=s.cost_per_unit,a=(0,n.mT)(i,s.unit||"g",t.unit||"g",s.ingredient_name),l=r*a,o=s.trim_peel_waste_percentage||0,d=s.yield_percentage||100,c=l*(1+o/100);return{recipeId:e,ingredientId:s.id,ingredientName:s.ingredient_name,quantity:r,unit:t.unit,costPerUnit:a,totalCost:l,wasteAdjustedCost:c,yieldAdjustedCost:c/(d/100)}});console.log("Converted to calculations:",r),u(r);let i=t.map(t=>({recipe_id:e,ingredient_id:t.ingredients.id,quantity:t.quantity,unit:t.unit}));d(i)}catch(e){console.log("Error in loadExistingRecipeIngredients:",e)}},[]),N=(0,i.useCallback)(async e=>{if(!e.trim())return null;try{console.log("Checking for recipe:",e.trim());let{data:t,error:s}=await g.ND.from("recipes").select("id, name").ilike("name",e.trim()),r=t&&t.length>0?t[0]:null;if(console.log("Recipe check result:",{existingRecipe:r,error:s}),s&&"PGRST116"===s.code)return console.log("Recipe not found - PGRST116 error"),!1;if(r)return console.log("Recipe found:",r),await j(r.id),!0;return console.log("Recipe not found - no data returned"),!1}catch(e){return console.log("Error checking recipe:",e),null}},[j]),y=(0,i.useCallback)((t,s)=>{u(r=>r.map(r=>{if(r.ingredientId===t){let i=e.find(e=>e.id===t);if(i){let e=s*r.costPerUnit,t=i.trim_peel_waste_percentage||0,n=i.yield_percentage||100,a=e*(1+t/100);return{...r,quantity:s,totalCost:e,wasteAdjustedCost:a,yieldAdjustedCost:a/(n/100)}}}return r}))},[e]),C=(0,i.useCallback)(e=>{u(t=>t.filter(t=>t.ingredientId!==e))},[]),w=(0,i.useCallback)(e=>{u(t=>[...t,e])},[]),k=(0,i.useCallback)(()=>{u([]),d([])},[]);return(0,i.useEffect)(()=>{a&&b(a)},[a,b]),(0,i.useEffect)(()=>{o.length>0&&v(o)},[o,v]),{ingredients:e,recipes:s,selectedRecipe:a,recipeIngredients:o,calculations:c,loading:x,error:h,fetchData:f,fetchRecipeIngredients:b,calculateCOGS:v,loadExistingRecipeIngredients:j,checkRecipeExists:N,updateCalculation:y,removeCalculation:C,addCalculation:w,clearCalculations:k,setSelectedRecipe:l,setError:p}})(),[w,k]=(0,i.useState)(""),[D,_]=(0,i.useState)(1),E=l.reduce((e,t)=>e+t.yieldAdjustedCost,0),S=E/(D||1),{targetGrossProfit:L,pricingStrategy:I,pricingCalculation:F,setTargetGrossProfit:P,setPricingStrategy:q}=(e=>{let[t,s]=(0,i.useState)(70),[r,n]=(0,i.useState)(0),[a,l]=(0,i.useState)(0),[o,d]=(0,i.useState)("charm"),c=(0,i.useCallback)((e,t,s)=>{let r=e/(1-t/100),i=r+.1*r,n=i;switch(s){case"charm":n=Math.ceil(i)-.01;break;case"whole":n=Math.ceil(i);break;case"real":n=i}let a=n/1.1,l=n-a,o=a-e;return{sellPriceExclGST:a,sellPriceInclGST:n,gstAmount:l,actualGrossProfit:(a-e)/a*100,grossProfitDollar:a-e,contributingMargin:o,contributingMarginPercent:o/a*100}},[]),u=(0,i.useMemo)(()=>e>0?c(e,t,o):null,[e,t,o,c]);return(0,i.useEffect)(()=>{e>0&&u&&(n(u.sellPriceExclGST),l(u.sellPriceInclGST))},[e,u]),{targetGrossProfit:t,sellPriceExclGST:r,sellPriceInclGST:a,pricingStrategy:o,pricingCalculation:u,setTargetGrossProfit:s,setPricingStrategy:d}})(S),{ingredientSearch:A,showSuggestions:M,selectedIngredient:G,newIngredient:R,filteredIngredients:B,handleIngredientSelect:T,handleSearchChange:W,resetForm:z,setNewIngredient:$,setShowSuggestions:O}=(e=>{let[t,s]=(0,i.useState)(""),[r,n]=(0,i.useState)(!1),[a,l]=(0,i.useState)(null),[o,d]=(0,i.useState)({ingredient_id:"",quantity:0,unit:"kg"}),c=(0,i.useMemo)(()=>{if(console.log("Filtering ingredients:",e.length,"total, search:",t),!t.trim()){let t=e.slice(0,50);return console.log("No search term, returning first 50:",t.length),t}let s=t.toLowerCase().trim(),r=e.filter(e=>e.ingredient_name.toLowerCase().includes(s)||e.unit&&e.unit.toLowerCase().includes(s)).sort((e,t)=>{let r=e.ingredient_name.toLowerCase(),i=t.ingredient_name.toLowerCase();return r.startsWith(s)&&!i.startsWith(s)?-1:!r.startsWith(s)&&i.startsWith(s)?1:r===s&&i!==s?-1:r!==s&&i===s?1:r.localeCompare(i)}).slice(0,20);return console.log("Search results:",r.length,"matches for",s),r},[e,t]),u=(0,i.useCallback)(e=>{console.log("Ingredient selected:",e.ingredient_name),l(e),d({...o,ingredient_id:e.id,unit:e.unit||"kg"}),s(e.ingredient_name),n(!1)},[o]),x=(0,i.useCallback)(e=>{s(e),n(e.length>0),l(null),d({...o,ingredient_id:""})},[o]),m=(0,i.useCallback)(()=>{d({ingredient_id:"",quantity:0,unit:"kg"}),s(""),l(null),n(!1)},[]);return{ingredientSearch:t,showSuggestions:r,selectedIngredient:a,newIngredient:o,filteredIngredients:c,setIngredientSearch:s,setShowSuggestions:n,setNewIngredient:d,handleIngredientSelect:u,handleSearchChange:x,resetForm:m}})(e),{loading:H,error:U,successMessage:Q,saveAsRecipe:V,setError:J,setSuccessMessage:K}=(()=>{let[e,t]=(0,i.useState)(!1),[s,r]=(0,i.useState)(null),[n,a]=(0,i.useState)(null);return{loading:e,error:s,successMessage:n,saveAsRecipe:(0,i.useCallback)(async(e,s,i)=>{if(0===e.length)return void r("No calculations to save. Please calculate COGS first.");let n=s||prompt("Enter a name for this recipe:");if(!n)return;let l=(0,o.xQ)(n);try{let s;t(!0),r(null);let{data:n,error:o}=await g.ND.from("recipes").select("id, name").ilike("name",l);console.log("Recipe check results:",{existingRecipes:n,checkError:o,recipeName:l});let d=n&&n.length>0?n[0]:null;if(console.log("Existing recipe found:",d),d&&!o){let{data:e,error:t}=await g.ND.from("recipes").update({yield:i||1,yield_unit:"servings",updated_at:new Date().toISOString()}).eq("id",d.id).select().single();if(t)return void r(t.message);s=e}else{let{data:e,error:t}=await g.ND.from("recipes").insert({name:l,yield:i||1,yield_unit:"servings"}).select().single();if(t)return void r(t.message);s=e}let c=e.map(e=>({recipe_id:s.id,ingredient_id:e.ingredientId,quantity:e.quantity,unit:e.unit}));if(d&&!o){let{error:e}=await g.ND.from("recipe_ingredients").delete().eq("recipe_id",d.id);if(e)return void r(e.message);let{error:t}=await g.ND.from("recipe_ingredients").insert(c);if(t)return void r(t.message)}else{let{error:e}=await g.ND.from("recipe_ingredients").insert(c);if(e)return void r(e.message)}r(null);let u=d&&!o?"updated":"saved";a('Recipe "'.concat(l,'" ').concat(u," successfully to Recipe Book!")),setTimeout(()=>a(null),5e3)}catch(e){console.log("Recipe save error:",e),r("Failed to save recipe"),a(null)}finally{t(!1)}},[]),clearMessages:(0,i.useCallback)(()=>{r(null),a(null)},[]),setError:r,setSuccessMessage:a}})(),[Y,X]=(0,i.useState)(!1),[Z,ee]=(0,i.useState)(null),[et,es]=(0,i.useState)(!1),[er,ei]=(0,i.useState)(!1),[en,ea]=(0,i.useState)(null),[el,eo]=(0,i.useState)(0);(0,i.useEffect)(()=>{f()},[f]),(0,i.useEffect)(()=>{let e=sessionStorage.getItem("editingRecipe");if(e)try{let{recipe:t,recipeId:s,calculations:r,dishName:i,dishPortions:n,dishNameLocked:a}=JSON.parse(e);console.log("\uD83D\uDD0D DEBUG: Loading from sessionStorage with recipeId:",{dishName:i,recipeId:s,calculationsCount:r.length}),k(i),_(n),X(a),sessionStorage.removeItem("editingRecipe"),K('Recipe "'.concat(i,'" loaded for editing!')),setTimeout(()=>K(null),3e3)}catch(e){console.log("Failed to parse editing data:",e)}},[K]),(0,i.useEffect)(()=>{let e=e=>{let t=e.target;t.closest(".ingredient-search-container")||t.closest(".suggestions-dropdown")||O(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,i.useEffect)(()=>{let e=setTimeout(async()=>{w.trim()&&!Y?(console.log("\uD83D\uDD0D DEBUG: Running recipe check for:",w),es(!0),ee(await y(w)),es(!1)):w.trim()?console.log("\uD83D\uDD0D DEBUG: Skipping recipe check - dish name locked (editing from recipe book)"):ee(null)},500);return()=>clearTimeout(e)},[w,Y,y]);let ed=async t=>{if(t.preventDefault(),!R.ingredient_id||!R.quantity)return void J("Please select an ingredient and enter a quantity");try{if(l.find(e=>e.ingredientId===R.ingredient_id)){let t=e.find(e=>e.id===R.ingredient_id);if(t){let e=R.quantity;R.unit;let s=(R.unit||"kg").toLowerCase().trim(),r=(t.unit||"kg").toLowerCase().trim(),i=["tsp","teaspoon","tbsp","tablespoon","cup","cups","ml","milliliter","l","liter","litre","fl oz","fluid ounce"],a=["g","gm","gram","grams","kg","kilogram","oz","ounce","lb","pound","mg","milligram"],o=i.includes(s),d=a.includes(s),c=i.includes(r),u=a.includes(r);if(o&&u||d&&c){let s=(0,n.oU)(R.quantity,R.unit||"kg",t.unit||"kg");e=R.quantity*s.conversionFactor,t.unit," (converted from ".concat(R.quantity," ").concat(R.unit||"kg",")")}let x=l.find(e=>e.ingredientId===R.ingredient_id);if(x){let t=x.quantity+e;v(R.ingredient_id,t)}}}else{let t=e.find(e=>e.id===R.ingredient_id);if(t){let e=R.quantity,r=R.unit||"kg",i="",a=(R.unit||"kg").toLowerCase().trim(),l=(t.unit||"kg").toLowerCase().trim(),o=["tsp","teaspoon","tbsp","tablespoon","cup","cups","ml","milliliter","l","liter","litre","fl oz","fluid ounce"],d=["g","gm","gram","grams","kg","kilogram","oz","ounce","lb","pound","mg","milligram"],c=o.includes(a),u=d.includes(a),x=o.includes(l),m=d.includes(l);if(c&&m||u&&x){let s=(0,n.oU)(R.quantity,R.unit||"kg",t.unit||"kg");e=R.quantity*s.conversionFactor,r=t.unit||"kg",i=" (converted from ".concat(R.quantity," ").concat(R.unit||"kg",")")}let g=t.cost_per_unit_incl_trim||t.cost_per_unit||0,h=e*g,p=t.trim_peel_waste_percentage||0,f=t.yield_percentage||100,b=h*(1+p/100),v={recipeId:s||"temp",ingredientId:R.ingredient_id,ingredientName:t.ingredient_name+i,quantity:e,unit:r,costPerUnit:g,totalCost:h,wasteAdjustedCost:b,yieldAdjustedCost:b/(f/100)};N(v)}}z()}catch(e){J("Failed to add ingredient")}};return h?(0,r.jsx)(a.JQ,{}):(0,r.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-4 sm:p-6",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"\uD83D\uDCB0 COGS Calculator"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Calculate Cost of Goods Sold and optimize your profit margins"})]}),(p||U)&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:p||U}),Q&&(0,r.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 border-2 border-green-400 text-white px-6 py-5 rounded-2xl mb-6 shadow-2xl animate-in slide-in-from-top-2 duration-500 transform scale-105 hover:scale-110 transition-all duration-300",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center animate-pulse",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-bold text-lg text-white",children:Q}),(0,r.jsx)("p",{className:"text-sm text-green-100 mt-1 font-medium",children:"\uD83C\uDF89 Your recipe has been added to the Recipe Book and is ready to use!"})]}),(0,r.jsx)("button",{onClick:()=>K(null),className:"flex-shrink-0 text-white/80 hover:text-white hover:bg-white/20 rounded-full p-2 transition-all duration-200",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d,{formData:{dishName:w,dishPortions:D,dishNameLocked:Y,recipeExists:Z,checkingRecipe:et},recipes:t,selectedRecipe:s,onDishNameChange:k,onDishPortionsChange:_,onRecipeSelect:b}),(0,r.jsx)(c,{showAddIngredient:er,ingredients:e,ingredientSearch:A,showSuggestions:M,filteredIngredients:B,selectedIngredient:G,newIngredient:R,onToggleAddIngredient:()=>{ei(!er),!er&&w.trim()&&X(!0),er&&X(!1)},onSearchChange:W,onIngredientSelect:T,onQuantityChange:e=>$({...R,quantity:e}),onUnitChange:e=>$({...R,unit:e}),onAddIngredient:ed})]}),(0,r.jsxs)("div",{className:"bg-[#1f1f1f] p-4 sm:p-6 rounded-lg shadow",children:[(0,r.jsx)("h2",{className:"text-lg sm:text-xl font-semibold mb-4",children:"Cost Analysis"}),(0,r.jsx)(u,{calculations:l,editingIngredient:en,editQuantity:el,onEditIngredient:(e,t)=>{ea(e),eo(t)},onSaveEdit:()=>{en&&el>0&&v(en,el),ea(null),eo(0)},onCancelEdit:()=>{ea(null),eo(0)},onRemoveIngredient:e=>{j(e)},onEditQuantityChange:eo,totalCOGS:E,costPerPortion:S,dishPortions:D}),(0,r.jsx)(x,{costPerPortion:S,targetGrossProfit:L,pricingStrategy:I,pricingCalculation:F,onTargetGrossProfitChange:P,onPricingStrategyChange:q}),(0,r.jsx)(m,{onSaveAsRecipe:()=>{V(l,w,D),X(!1)}})]})]}),0===t.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83D\uDCCA"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"No recipes available"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Create some recipes first to calculate their COGS."}),(0,r.jsx)("a",{href:"/webapp/recipes",className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white px-4 py-2 rounded-lg hover:from-[#29E7CD]/80 hover:to-[#D925C7]/80 transition-colors",children:"Go to Recipes"})]})]})})}function p(){return(0,r.jsx)(l.tH,{children:(0,r.jsx)(h,{})})}},97666:(e,t,s)=>{Promise.resolve().then(s.bind(s,42142))}},e=>{e.O(0,[8888,1459,563,8650,8405,9420,622,7979,1899,4450,9324,8585,9592,433,2652,3494,2574,9173,3023,1356,309,4191,2834,957,6691,1151,9473,9219,6053,3376,2076,7358],()=>e(e.s=97666)),_N_E=e.O()}]);