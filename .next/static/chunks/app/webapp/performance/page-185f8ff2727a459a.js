(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6555],{29828:(e,t,r)=>{Promise.resolve().then(r.bind(r,37779))},37779:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>C});var a=r(95155);function s(e){let{performanceScore:t,realtimeEnabled:r,lastUpdate:s,performanceAlerts:l}=e;return(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Performance Analysis"}),(0,a.jsx)("p",{className:"text-gray-300 text-lg",children:"Analyze your menu performance and profitability"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Performance Score"}),(0,a.jsxs)("div",{className:"text-2xl font-bold ".concat(t>=90?"text-green-400":t>=70?"text-yellow-400":"text-red-400"),children:[t,"/100"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(r?"bg-green-400 animate-pulse":"bg-gray-400")}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:r?"Live":"Offline"})]}),s&&(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Last Update"}),(0,a.jsx)("div",{className:"text-xs text-gray-300",children:s.toLocaleTimeString()})]})]})]}),l.length>0&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsx)("span",{className:"text-yellow-400 font-medium",children:"Performance Alerts"})]}),(0,a.jsx)("div",{className:"space-y-1",children:l.slice(-3).map(e=>(0,a.jsx)("div",{className:"text-sm text-yellow-300",children:e.message},e.id))})]})]})}function l(e){var t,r,s,l,n;let{metadata:o}=e;return o?(0,a.jsxs)("div",{className:"bg-[#1f1f1f] rounded-2xl border border-[#2a2a2a] p-6 mb-8",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"PrepFlow COGS Dynamic Methodology"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Methodology"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-[#29E7CD]",children:o.methodology})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Average Profit Margin"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-white",children:[null==(t=o.averageProfitMargin)?void 0:t.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Average Popularity"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-white",children:[null==(r=o.averagePopularity)?void 0:r.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-400 mb-1",children:"Popularity Threshold"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-[#D925C7]",children:[null==(s=o.popularityThreshold)?void 0:s.toFixed(1),"%"]})]})]}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-300",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Profit Check:"})," HIGH if above menu average (",null==(l=o.averageProfitMargin)?void 0:l.toFixed(1),"%), LOW if below"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Popularity Check:"})," HIGH if â‰¥ 80% of average popularity (",null==(n=o.popularityThreshold)?void 0:n.toFixed(1),"%), LOW if below"]})]})]}):null}function n(e){let{filters:t,onFiltersChange:r}=e,s=(e,a)=>{r({...t,[e]:a})};return(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-300 mb-2",children:"Search"}),(0,a.jsx)("input",{type:"text",placeholder:"Search dishes...",value:t.searchTerm,onChange:e=>s("searchTerm",e.target.value),className:"px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent text-base"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-300 mb-2",children:"Sort By"}),(0,a.jsxs)("select",{value:t.sortBy,onChange:e=>s("sortBy",e.target.value),className:"px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent text-base",children:[(0,a.jsx)("option",{value:"gross_profit_percentage",children:"Gross Profit %"}),(0,a.jsx)("option",{value:"number_sold",children:"Number Sold"}),(0,a.jsx)("option",{value:"popularity_percentage",children:"Popularity %"}),(0,a.jsx)("option",{value:"name",children:"Name"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-300 mb-2",children:"Order"}),(0,a.jsxs)("select",{value:t.sortOrder,onChange:e=>s("sortOrder",e.target.value),className:"px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent text-base",children:[(0,a.jsx)("option",{value:"desc",children:"Descending"}),(0,a.jsx)("option",{value:"asc",children:"Ascending"})]})]})]})}function o(e){let{showImportModal:t,showCharts:r,realtimeEnabled:s,onImportClick:l,onExportCSV:n,onToggleCharts:o,onToggleRealtime:i}=e;return(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 sm:gap-4 mb-8",children:[(0,a.jsxs)("button",{onClick:l,className:"bg-[#29E7CD] hover:bg-[#29E7CD]/80 text-black px-4 sm:px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm sm:text-base min-h-[44px]",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Import Sales Data"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Import"})]}),(0,a.jsxs)("button",{onClick:n,className:"bg-[#3B82F6] hover:bg-[#3B82F6]/80 text-white px-4 sm:px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm sm:text-base min-h-[44px]",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Export CSV"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Export"})]}),(0,a.jsxs)("button",{onClick:o,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 sm:px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm sm:text-base min-h-[44px]",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{d:r?"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z":"M10 12a2 2 0 100-4 2 2 0 000 4zM3.05 13a1 1 0 011.414 0L9 16.536V19a1 1 0 11-2 0v-2.464L4.464 13a1 1 0 010-1.414zM16.95 7a1 1 0 010 1.414L14.536 10H17a1 1 0 110 2h-2.464l2.414 2.414a1 1 0 11-1.414 1.414L12 13.414V16a1 1 0 11-2 0v-2.586l-2.414 2.414a1 1 0 11-1.414-1.414L10.536 12H8a1 1 0 110-2h2.536L8.122 7.586a1 1 0 111.414-1.414L12 8.586V6a1 1 0 112 0v2.586l2.414-2.414A1 1 0 0116.95 7z"})}),(0,a.jsx)("span",{className:"hidden sm:inline",children:r?"Hide Charts":"Show Charts"}),(0,a.jsx)("span",{className:"sm:hidden",children:r?"Hide":"Charts"})]}),(0,a.jsxs)("button",{onClick:i,className:"px-4 sm:px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm sm:text-base min-h-[44px] ".concat(s?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-600 hover:bg-gray-700 text-white"),children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s?"bg-green-400 animate-pulse":"bg-gray-400")}),(0,a.jsx)("span",{className:"hidden sm:inline",children:s?"Disable Real-time":"Enable Real-time"}),(0,a.jsx)("span",{className:"sm:hidden",children:s?"Disable":"Real-time"})]})]})}var i=r(12115),c=r(12090),d=r(98128),m=r(68425),x=r(69386),p=r(37665),h=r(12235),g=r(10281),u=r(26991),f=r(96112),b=r(47734),y=r(73697);function j(e){let{performanceItems:t}=e,[r,s]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=()=>{s(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let l=[{name:"Chef's Kiss",profit:t.filter(e=>"Chef's Kiss"===e.menu_item_class).reduce((e,t)=>e+t.gross_profit_percentage,0)/Math.max(1,t.filter(e=>"Chef's Kiss"===e.menu_item_class).length)},{name:"Hidden Gem",profit:t.filter(e=>"Hidden Gem"===e.menu_item_class).reduce((e,t)=>e+t.gross_profit_percentage,0)/Math.max(1,t.filter(e=>"Hidden Gem"===e.menu_item_class).length)},{name:"Bargain Bucket",profit:t.filter(e=>"Bargain Bucket"===e.menu_item_class).reduce((e,t)=>e+t.gross_profit_percentage,0)/Math.max(1,t.filter(e=>"Bargain Bucket"===e.menu_item_class).length)},{name:"Burnt Toast",profit:t.filter(e=>"Burnt Toast"===e.menu_item_class).reduce((e,t)=>e+t.gross_profit_percentage,0)/Math.max(1,t.filter(e=>"Burnt Toast"===e.menu_item_class).length)}],n=[{name:"Chef's Kiss",value:t.filter(e=>"Chef's Kiss"===e.menu_item_class).length,color:"#22c55e"},{name:"Hidden Gem",value:t.filter(e=>"Hidden Gem"===e.menu_item_class).length,color:"#3b82f6"},{name:"Bargain Bucket",value:t.filter(e=>"Bargain Bucket"===e.menu_item_class).length,color:"#f97316"},{name:"Burnt Toast",value:t.filter(e=>"Burnt Toast"===e.menu_item_class).length,color:"#ef4444"}];return(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-[#1f1f1f] rounded-2xl border border-[#2a2a2a] p-4 md:p-6",children:[(0,a.jsx)("h3",{className:"text-lg md:text-xl font-semibold text-white mb-4",children:"Profit by Category"}),(0,a.jsx)("div",{className:"h-64 md:h-80 w-full",children:(0,a.jsx)(u.u,{width:"100%",height:"100%",children:(0,a.jsxs)(d.E,{data:l,margin:{top:20,right:r?10:30,left:r?10:20,bottom:5},children:[(0,a.jsx)(m.d,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),(0,a.jsx)(b.W,{dataKey:"name",stroke:"#9ca3af",fontSize:r?10:12,tick:{fill:"#9ca3af"},angle:r?-45:0,textAnchor:r?"end":"middle",height:r?60:30}),(0,a.jsx)(y.h,{stroke:"#9ca3af",fontSize:r?10:12,tick:{fill:"#9ca3af"},tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(f.m,{contentStyle:{backgroundColor:"rgba(31, 31, 31, 0.95)",border:"1px solid #29E7CD",borderRadius:"8px",color:"#ffffff",fontSize:r?"12px":"14px"},labelStyle:{color:"#ffffff"},formatter:e=>["".concat(e.toFixed(1),"%"),"Average Profit"]}),(0,a.jsx)(c.y,{dataKey:"profit",fill:"#29E7CD",radius:[4,4,0,0]})]})})})]}),(0,a.jsxs)("div",{className:"bg-[#1f1f1f] rounded-2xl border border-[#2a2a2a] p-4 md:p-6",children:[(0,a.jsx)("h3",{className:"text-lg md:text-xl font-semibold text-white mb-4",children:"Category Distribution"}),(0,a.jsx)("div",{className:"h-64 md:h-80 w-full",children:(0,a.jsx)(u.u,{width:"100%",height:"100%",children:(0,a.jsxs)(g.r,{children:[(0,a.jsx)(h.F,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,value:a}=e;return r?"".concat(t):"".concat(t,": ").concat(a)},outerRadius:r?60:80,fill:"#8884d8",dataKey:"value",children:n.map((e,t)=>(0,a.jsx)(x.f,{fill:e.color},"cell-".concat(t)))}),(0,a.jsx)(f.m,{contentStyle:{backgroundColor:"rgba(31, 31, 31, 0.95)",border:"1px solid #29E7CD",borderRadius:"8px",color:"#ffffff",fontSize:r?"12px":"14px"},labelStyle:{color:"#ffffff"},formatter:(e,t)=>["".concat(e," items"),t]}),(0,a.jsx)(p.s,{wrapperStyle:{color:"#ffffff",fontSize:r?"10px":"12px"},verticalAlign:"bottom",height:r?30:36})]})})})]})]})}function v(e){let{performanceItems:t}=e,r=e=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(e),s=e=>"".concat(e.toFixed(2),"%");return(0,a.jsxs)("div",{className:"bg-[#1f1f1f] rounded-2xl border border-[#2a2a2a] overflow-hidden",children:[(0,a.jsx)("div",{className:"block md:hidden",children:(0,a.jsx)("div",{className:"p-4 space-y-4",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"bg-[#2a2a2a]/30 rounded-xl border border-[#3a3a3a] p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:e.name}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("Chef's Kiss"===e.menu_item_class?"bg-green-500/20 text-green-400 border border-green-500/30":"Hidden Gem"===e.menu_item_class?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"Bargain Bucket"===e.menu_item_class?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"),children:e.menu_item_class})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-[#1f1f1f] rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-gray-400 mb-1",children:"Number Sold"}),(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:e.number_sold})]}),(0,a.jsxs)("div",{className:"bg-[#1f1f1f] rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-gray-400 mb-1",children:"Popularity"}),(0,a.jsxs)("div",{className:"text-lg font-bold text-[#3B82F6]",children:[e.popularity_percentage.toFixed(1),"%"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Gross Profit %"}),(0,a.jsx)("span",{className:"text-lg font-bold text-[#29E7CD]",children:s(e.gross_profit_percentage)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Total Revenue"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:r(e.selling_price*e.number_sold/1.1)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Total Cost"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:r(e.food_cost*e.number_sold)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Total Profit"}),(0,a.jsx)("span",{className:"text-sm font-medium text-white",children:r(e.gross_profit*e.number_sold)})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("High"===e.profit_category?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"),children:["Profit: ",e.profit_category]}),(0,a.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("High"===e.popularity_category?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-orange-500/20 text-orange-400 border border-orange-500/30"),children:["Popularity: ",e.popularity_category]})]})]},e.id))})}),(0,a.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gradient-to-r from-[#2a2a2a]/50 to-[#2a2a2a]/20",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Dish"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Number Sold"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Popularity %"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Total Revenue ex GST"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Total Cost"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Total Profit ex GST"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Gross Profit %"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Profit Cat"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Popularity Cat"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Menu Item Class"})]})}),(0,a.jsx)("tbody",{children:t.map((e,t)=>(0,a.jsxs)("tr",{className:"border-t border-[#2a2a2a] hover:bg-[#2a2a2a]/20 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-white font-medium",children:e.name}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-300 text-center",children:e.number_sold}),(0,a.jsxs)("td",{className:"px-4 py-3 text-gray-300 text-center",children:[e.popularity_percentage.toFixed(2),"%"]}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-300 text-center",children:r(e.selling_price*e.number_sold/1.1)}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-300 text-center",children:r(e.food_cost*e.number_sold)}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-300 text-center",children:r(e.gross_profit*e.number_sold)}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-300 text-center",children:s(e.gross_profit_percentage)}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("High"===e.profit_category?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"),children:e.profit_category})}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("High"===e.popularity_category?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-orange-500/20 text-orange-400 border border-orange-500/30"),children:e.popularity_category})}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("Chef's Kiss"===e.menu_item_class?"bg-green-500/20 text-green-400 border border-green-500/30":"Hidden Gem"===e.menu_item_class?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"Bargain Bucket"===e.menu_item_class?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"),children:e.menu_item_class})})]},e.id))})]})})]})}function N(e){let{currentPage:t,totalPages:r,onPageChange:s}=e;return r<=1?null:(0,a.jsxs)("div",{className:"flex justify-center items-center space-x-2 mt-8",children:[(0,a.jsx)("button",{onClick:()=>s(Math.max(1,t-1)),disabled:1===t,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-800 disabled:text-gray-500 text-white rounded-lg transition-colors",children:"Previous"}),(0,a.jsxs)("span",{className:"px-4 py-2 text-gray-300",children:["Page ",t," of ",r]}),(0,a.jsx)("button",{onClick:()=>s(Math.min(r,t+1)),disabled:t===r,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-800 disabled:text-gray-500 text-white rounded-lg transition-colors",children:"Next"})]})}function _(e){let{showImportModal:t,csvData:r,onClose:s,onImport:l,onCsvDataChange:n}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-[#1f1f1f] rounded-2xl border border-[#2a2a2a] p-6 w-full max-w-2xl",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Import Sales Data"}),(0,a.jsx)("p",{className:"text-gray-300 mb-4",children:"Paste your CSV data below. Format: Dish, Number Sold, Popularity %"}),(0,a.jsx)("textarea",{value:r.csvData,onChange:e=>n(e.target.value),placeholder:"Dish, Number Sold, Popularity % Double Cheese Burger, 175, 10.85 Hot Dog, 158, 9.80",className:"w-full h-40 px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent resize-none"}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,a.jsx)("button",{onClick:s,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:l,disabled:r.importing||!r.csvData.trim(),className:"px-6 py-2 bg-[#29E7CD] hover:bg-[#29E7CD]/80 disabled:bg-gray-600 text-black rounded-lg transition-colors",children:r.importing?"Importing...":"Import"})]})]})}):null}var w=r(67928);function C(){let{state:e,updateState:t,setupRealtimeSubscription:r,handleImport:c,handleExportCSV:d,realtimeSubscription:m}=function(){let[e,t]=(0,i.useState)({performanceItems:[],metadata:null,performanceAlerts:[],performanceScore:0,realtimeEnabled:!1,lastUpdate:null,showCharts:!1,showImportModal:!1,csvData:"",importing:!1}),r=(0,i.useRef)(null),a=async()=>{try{let e=await fetch("/api/performance");if(!e.ok)throw Error("Failed to fetch performance data");let r=await e.json();t(e=>({...e,performanceItems:r.performanceItems||[],metadata:r.metadata||null,performanceAlerts:r.performanceAlerts||[],performanceScore:r.performanceScore||0,lastUpdate:new Date}))}catch(e){console.error("Error fetching performance data:",e),t(e=>({...e,performanceAlerts:[...e.performanceAlerts,{id:Date.now().toString(),message:"Failed to fetch performance data",timestamp:new Date}]}))}},s=async()=>{if(e.csvData.trim()){t(e=>({...e,importing:!0}));try{let r=e.csvData.trim().split("\n");if(r[0].split(",").map(e=>e.trim()).length<3)throw Error("CSV must have at least 3 columns: Dish, Number Sold, Popularity %");let s=r.slice(1).map(e=>{let t=e.split(",").map(e=>e.trim());return{dish_name:t[0],number_sold:parseInt(t[1])||0,popularity_percentage:parseFloat(t[2])||0}});if(!(await fetch("/api/performance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({salesData:s})})).ok)throw Error("Failed to import sales data");t(e=>({...e,csvData:"",showImportModal:!1,importing:!1})),await a()}catch(e){console.error("Error importing data:",e),t(e=>({...e,importing:!1,performanceAlerts:[...e.performanceAlerts,{id:Date.now().toString(),message:"Failed to import sales data",timestamp:new Date}]}))}}};return(0,i.useEffect)(()=>{a()},[]),{state:e,updateState:e=>{t(t=>({...t,...e}))},fetchPerformanceData:a,setupRealtimeSubscription:()=>{r.current&&r.current.unsubscribe(),r.current=w.ND.channel("performance-updates").on("postgres_changes",{event:"*",schema:"public",table:"sales_data"},e=>{console.log("Performance data updated:",e),a()}).subscribe()},handleImport:s,handleExportCSV:()=>{let t=new Blob([["Dish,Number Sold,Popularity %,Total Revenue ex GST,Total Cost,Total Profit ex GST,Gross Profit %,Profit Cat,Popularity Cat,Menu Item Class",...e.performanceItems.map(e=>[e.name,e.number_sold,e.popularity_percentage.toFixed(2),(e.selling_price*e.number_sold/1.1).toFixed(2),(e.food_cost*e.number_sold).toFixed(2),(e.gross_profit*e.number_sold).toFixed(2),e.gross_profit_percentage.toFixed(2),e.profit_category,e.popularity_category,e.menu_item_class].join(","))].join("\n")],{type:"text/csv"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="performance-data-".concat(new Date().toISOString().split("T")[0],".csv"),a.click(),window.URL.revokeObjectURL(r)},realtimeSubscription:r}}(),{filters:x,updateFilters:p,paginatedItems:h,totalPages:g}=function(e){let[t,r]=(0,i.useState)({searchTerm:"",sortBy:"gross_profit_percentage",sortOrder:"desc",currentPage:1,itemsPerPage:20}),a=(0,i.useMemo)(()=>{let r=e.filter(e=>e.name.toLowerCase().includes(t.searchTerm.toLowerCase()));return r.sort((e,r)=>{let a,s;switch(t.sortBy){case"gross_profit_percentage":default:a=e.gross_profit_percentage,s=r.gross_profit_percentage;break;case"number_sold":a=e.number_sold,s=r.number_sold;break;case"popularity_percentage":a=e.popularity_percentage,s=r.popularity_percentage;break;case"name":a=e.name.toLowerCase(),s=r.name.toLowerCase()}return"asc"===t.sortOrder?a>s?1:-1:a<s?1:-1}),r},[e,t.searchTerm,t.sortBy,t.sortOrder]),s=(0,i.useMemo)(()=>{let e=(t.currentPage-1)*t.itemsPerPage,r=e+t.itemsPerPage;return a.slice(e,r)},[a,t.currentPage,t.itemsPerPage]),l=Math.ceil(a.length/t.itemsPerPage);return{filters:t,updateFilters:e=>{r(t=>({...t,...e,currentPage:void 0!==e.searchTerm||void 0!==e.sortBy||void 0!==e.sortOrder?1:t.currentPage}))},filteredAndSortedItems:a,paginatedItems:s,totalPages:l}}(e.performanceItems);return(0,a.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] text-white p-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)(s,{performanceScore:e.performanceScore,realtimeEnabled:e.realtimeEnabled,lastUpdate:e.lastUpdate,performanceAlerts:e.performanceAlerts}),(0,a.jsx)(l,{metadata:e.metadata}),(0,a.jsx)(n,{filters:x,onFiltersChange:p}),(0,a.jsx)(o,{showImportModal:e.showImportModal,showCharts:e.showCharts,realtimeEnabled:e.realtimeEnabled,onImportClick:()=>{t({showImportModal:!0})},onExportCSV:d,onToggleCharts:()=>{t({showCharts:!e.showCharts})},onToggleRealtime:()=>{let a=!e.realtimeEnabled;t({realtimeEnabled:a}),a?r():m.current&&m.current.unsubscribe()}}),e.showCharts&&(0,a.jsx)(j,{performanceItems:e.performanceItems}),(0,a.jsx)(v,{performanceItems:h}),(0,a.jsx)(N,{currentPage:x.currentPage,totalPages:g,onPageChange:e=>{p({currentPage:e})}}),(0,a.jsx)(_,{showImportModal:e.showImportModal,csvData:{csvData:e.csvData,importing:e.importing},onClose:()=>{t({showImportModal:!1,csvData:""})},onImport:c,onCsvDataChange:e=>{t({csvData:e})}})]})})}}},e=>{e.O(0,[8888,1459,563,8650,8405,9420,622,7979,1899,4450,9324,8585,9592,433,2652,3494,2574,9173,3023,1356,309,4191,2834,957,6691,1151,9473,9219,6053,3376,2076,7358],()=>e(e.s=29828)),_N_E=e.O()}]);