(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5901],{23454:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_});var s=a(95155),r=a(67928),n=a(12115),i=a(54224),l=a(34908),c=a(12104),o=a(50160);function d(e){let{ingredients:t,displayUnit:a,onEdit:r,onDelete:i,selectedIngredients:d,onSelectIngredient:u,onSelectAll:x,loading:p=!1}=e,{t:m}=(0,l.Bd)(),[g,h]=(0,n.useState)(null),b=async e=>{if(window.confirm("Are you sure you want to delete this ingredient?")){h(e);try{await i(e)}finally{h(null)}}};return p?(0,s.jsx)("div",{className:"bg-[#1f1f1f] rounded-3xl p-6 border border-[#2a2a2a]",children:(0,s.jsx)(c.O0,{variant:"table"})}):0===t.length?(0,s.jsx)("div",{className:"bg-[#1f1f1f] rounded-3xl p-6 border border-[#2a2a2a] text-center",children:(0,s.jsxs)("div",{className:"text-gray-400 mb-4",children:[(0,s.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zm0 4a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1V8zm8 0a1 1 0 011-1h4a1 1 0 011 1v6a1 1 0 01-1 1h-4a1 1 0 01-1-1V8z",clipRule:"evenodd"})}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Ingredients Found"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Start by adding your first ingredient to get started."})]})}):(0,s.jsxs)("div",{className:"bg-[#1f1f1f] rounded-3xl border border-[#2a2a2a] overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 bg-gradient-to-r from-[#2a2a2a]/50 to-[#2a2a2a]/20",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-white",children:["Ingredients (",t.length,")"]}),(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-300",children:[(0,s.jsx)("input",{type:"checkbox",checked:d.size===t.length&&t.length>0,onChange:e=>x(e.target.checked),className:"w-4 h-4 text-[#29E7CD] bg-[#2a2a2a] border-[#2a2a2a] rounded focus:ring-[#29E7CD] focus:ring-2"}),"Select All"]})})]})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gradient-to-r from-[#2a2a2a]/50 to-[#2a2a2a]/20",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:(0,s.jsx)("input",{type:"checkbox",checked:d.size===t.length&&t.length>0,onChange:e=>x(e.target.checked),className:"w-4 h-4 text-[#29E7CD] bg-[#2a2a2a] border-[#2a2a2a] rounded focus:ring-[#29E7CD] focus:ring-2"})}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Brand"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Pack Size"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Cost/Unit"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Supplier"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Stock"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-[#2a2a2a]",children:t.map(e=>{let t=(0,o.mT)(e.cost_per_unit,e.unit||"GM",a,e.ingredient_name||"Unknown"),n=e.min_stock_level&&e.current_stock&&e.current_stock<=e.min_stock_level;return(0,s.jsxs)("tr",{className:"hover:bg-[#2a2a2a]/20 transition-colors duration-200",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("input",{type:"checkbox",checked:d.has(e.id),onChange:t=>u(e.id,t.target.checked),className:"w-4 h-4 text-[#29E7CD] bg-[#2a2a2a] border-[#2a2a2a] rounded focus:ring-[#29E7CD] focus:ring-2"})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-white",children:e.ingredient_name}),e.product_code&&(0,s.jsx)("div",{className:"text-sm text-gray-400",children:e.product_code})]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:e.brand||"-"}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:[e.pack_size," ",e.pack_size_unit]}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:[new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:2,maximumFractionDigits:4}).format(t),"/",a]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:e.supplier||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-sm ".concat(n?"text-red-400":"text-gray-300"),children:[e.current_stock||0," ",e.unit]}),n&&(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-900/20 text-red-400",children:"Low Stock"})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>r(e),className:"text-[#29E7CD] hover:text-[#29E7CD]/80 transition-colors","aria-label":"Edit ".concat(e.ingredient_name),children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,s.jsx)("button",{onClick:()=>b(e.id),disabled:g===e.id,className:"text-red-400 hover:text-red-300 transition-colors disabled:opacity-50","aria-label":"Delete ".concat(e.ingredient_name),children:g===e.id?(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-red-400 border-t-transparent rounded-full animate-spin"}):(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},e.id)})})]})})]})}function u(e){let{ingredients:t,searchTerm:a,supplierFilter:r,storageFilter:n,sortBy:i,displayUnit:c,onSearchChange:o,onSupplierFilterChange:d,onStorageFilterChange:u,onSortChange:x,onDisplayUnitChange:p}=e,{t:m}=(0,l.Bd)(),g=Array.from(new Set(t.map(e=>e.supplier).filter(Boolean))).sort(),h=Array.from(new Set(t.map(e=>e.storage_location).filter(Boolean))).sort();return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-[#1f1f1f] p-4 rounded-lg border border-[#2a2a2a]",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Display costs in:"}),(0,s.jsxs)("select",{value:c,onChange:e=>p(e.target.value),className:"px-3 py-2 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",children:[(0,s.jsxs)("optgroup",{label:"Weight",children:[(0,s.jsx)("option",{value:"g",children:"Grams (g)"}),(0,s.jsx)("option",{value:"kg",children:"Kilograms (kg)"}),(0,s.jsx)("option",{value:"oz",children:"Ounces (oz)"}),(0,s.jsx)("option",{value:"lb",children:"Pounds (lb)"})]}),(0,s.jsxs)("optgroup",{label:"Volume",children:[(0,s.jsx)("option",{value:"ml",children:"Milliliters (ml)"}),(0,s.jsx)("option",{value:"l",children:"Liters (L)"}),(0,s.jsx)("option",{value:"tsp",children:"Teaspoons (tsp)"}),(0,s.jsx)("option",{value:"tbsp",children:"Tablespoons (tbsp)"}),(0,s.jsx)("option",{value:"cup",children:"Cups"})]})]})]})}),(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-4 sm:p-6 rounded-lg shadow border border-[#2a2a2a]",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83D\uDD0D Search"}),(0,s.jsx)("input",{type:"text",placeholder:"Search ingredients...",value:a,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-md focus:outline-none focus:ring-2 focus:ring-[#29E7CD] placeholder-gray-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83C\uDFEA Supplier"}),(0,s.jsxs)("select",{value:r,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-md focus:outline-none focus:ring-2 focus:ring-[#29E7CD]",children:[(0,s.jsx)("option",{value:"",children:"All Suppliers"}),g.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83D\uDCCD Storage"}),(0,s.jsxs)("select",{value:n,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-md focus:outline-none focus:ring-2 focus:ring-[#29E7CD]",children:[(0,s.jsx)("option",{value:"",children:"All Locations"}),h.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"\uD83D\uDCCA Sort By"}),(0,s.jsxs)("select",{value:i,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-md focus:outline-none focus:ring-2 focus:ring-[#29E7CD]",children:[(0,s.jsx)("option",{value:"name",children:"Name"}),(0,s.jsx)("option",{value:"cost_asc",children:"Cost (Low to High)"}),(0,s.jsx)("option",{value:"cost_desc",children:"Cost (High to Low)"}),(0,s.jsx)("option",{value:"supplier",children:"Supplier"})]})]})]}),(a||r||n)&&(0,s.jsx)("div",{className:"mt-4 pt-4 border-t border-[#2a2a2a]",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("span",{className:"text-sm text-gray-400",children:"Active filters:"}),a&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-[#29E7CD]/10 text-[#29E7CD] border border-[#29E7CD]/20",children:['Search: "',a,'"']}),r&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-[#3B82F6]/10 text-[#3B82F6] border border-[#3B82F6]/20",children:["Supplier: ",r]}),n&&(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-[#D925C7]/10 text-[#D925C7] border border-[#D925C7]/20",children:["Storage: ",n]}),(0,s.jsx)("button",{onClick:()=>{o(""),d(""),u("")},className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-600/10 text-gray-400 hover:text-white border border-gray-600/20 hover:border-gray-500/40 transition-colors",children:"Clear All"})]})})]})]})}function x(e){let{selectedIngredients:t,filteredIngredients:a,onAddIngredient:r,onImportCSV:i,onExportCSV:c,onBulkDelete:o,onBulkUpdate:d,loading:u=!1}=e,{t:x}=(0,l.Bd)(),[p,m]=(0,n.useState)(!1),[g,h]=(0,n.useState)(!1),b=t.size;a.filter(e=>t.has(e.id));let f=async()=>{if(0===b)return;let e="Are you sure you want to delete ".concat(b," ingredient").concat(b>1?"s":"","?");if(window.confirm(e)){m(!0);try{await o(Array.from(t))}finally{m(!1),h(!1)}}},j=async()=>{if(0===b)return;let e=window.prompt("Enter new supplier for ".concat(b," ingredient").concat(b>1?"s":"",":"));if(null==e?void 0:e.trim()){m(!0);try{await d(Array.from(t),{supplier:e.trim()})}finally{m(!1),h(!1)}}},_=async()=>{if(0===b)return;let e=window.prompt("Enter new storage location for ".concat(b," ingredient").concat(b>1?"s":"",":"));if(null==e?void 0:e.trim()){m(!0);try{await d(Array.from(t),{storage_location:e.trim()})}finally{m(!1),h(!1)}}},v=async()=>{if(0===b)return;let e=window.prompt("Enter wastage percentage (0-100) for ".concat(b," ingredient").concat(b>1?"s":"",":"));if(!e)return;let a=parseFloat(e);if(isNaN(a)||a<0||a>100)return void alert("Please enter a valid percentage between 0 and 100");m(!0);try{await d(Array.from(t),{trim_peel_waste_percentage:a,yield_percentage:100-a})}finally{m(!1),h(!1)}};return(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 mb-6",children:[(0,s.jsx)("button",{onClick:r,className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white px-4 py-2 rounded-lg hover:from-[#29E7CD]/80 hover:to-[#D925C7]/80 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"+ Add Ingredient"}),(0,s.jsx)("button",{onClick:i,className:"bg-gradient-to-r from-[#3B82F6] to-[#29E7CD] text-white px-4 py-2 rounded-lg hover:from-[#3B82F6]/80 hover:to-[#29E7CD]/80 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"\uD83D\uDCC1 Import CSV"}),(0,s.jsx)("button",{onClick:c,className:"bg-gradient-to-r from-[#D925C7] to-[#3B82F6] text-white px-4 py-2 rounded-lg hover:from-[#D925C7]/80 hover:to-[#3B82F6]/80 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:"\uD83D\uDCE4 Export CSV"}),b>0&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>h(!g),className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-4 py-2 rounded-lg hover:from-orange-500/80 hover:to-red-500/80 transition-all duration-200 shadow-lg hover:shadow-xl font-medium",children:["⚡ Bulk Actions (",b,")"]}),g&&(0,s.jsx)("div",{className:"absolute top-full left-0 mt-2 w-64 bg-[#1f1f1f] border border-[#2a2a2a] rounded-lg shadow-xl z-10",children:(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsxs)("div",{className:"text-xs text-gray-400 px-3 py-2 border-b border-[#2a2a2a]",children:[b," ingredient",b>1?"s":""," selected"]}),(0,s.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,s.jsx)("button",{onClick:f,disabled:p,className:"w-full text-left px-3 py-2 text-red-400 hover:bg-red-500/10 rounded transition-colors disabled:opacity-50",children:"\uD83D\uDDD1️ Delete Selected"}),(0,s.jsx)("button",{onClick:j,disabled:p,className:"w-full text-left px-3 py-2 text-gray-300 hover:bg-[#2a2a2a] rounded transition-colors disabled:opacity-50",children:"\uD83C\uDFEA Update Supplier"}),(0,s.jsx)("button",{onClick:_,disabled:p,className:"w-full text-left px-3 py-2 text-gray-300 hover:bg-[#2a2a2a] rounded transition-colors disabled:opacity-50",children:"\uD83D\uDCCD Update Storage Location"}),(0,s.jsx)("button",{onClick:v,disabled:p,className:"w-full text-left px-3 py-2 text-gray-300 hover:bg-[#2a2a2a] rounded transition-colors disabled:opacity-50",children:"\uD83C\uDFAF Update Wastage %"})]})]})})]}),(u||p)&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-400",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-[#29E7CD] border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-sm",children:p?"Processing...":"Loading..."})]}),b>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[(0,s.jsx)("span",{children:"Selected:"}),(0,s.jsx)("span",{className:"text-[#29E7CD] font-medium",children:b}),(0,s.jsx)("span",{children:"of"}),(0,s.jsx)("span",{className:"text-white font-medium",children:a.length})]})]})}function p(e){let{ingredient:t,suppliers:a,availableUnits:r,onSave:c,onCancel:d,loading:u=!1}=e,{t:x}=(0,l.Bd)(),[p,m]=(0,n.useState)({ingredient_name:"",brand:"",pack_size:"",pack_size_unit:"GM",pack_price:0,unit:"GM",cost_per_unit:0,cost_per_unit_as_purchased:0,cost_per_unit_incl_trim:0,trim_peel_waste_percentage:0,yield_percentage:100,supplier:"",product_code:"",storage_location:"",min_stock_level:0,current_stock:0,...t}),[g,h]=(0,n.useState)({}),b=()=>{if(p.pack_price&&p.pack_size&&p.pack_size_unit&&p.unit){var e,t,a,s;let r=(e=p.pack_price,t=parseFloat(p.pack_size),a=p.pack_size_unit,s=p.unit,0===e||0===t?0:e/(t*(0,o.oU)(1,a,s).conversionFactor));m(e=>({...e,cost_per_unit:r,cost_per_unit_as_purchased:r,cost_per_unit_incl_trim:r}))}},f=(e,t)=>{let a="string"==typeof t?(0,i.$m)(t):t;m(t=>({...t,[e]:a})),g[e]&&h(t=>({...t,[e]:""})),["pack_price","pack_size","pack_size_unit","unit"].includes(e)&&setTimeout(b,100)},j=async e=>{if(e.preventDefault(),(()=>{var e;let t={};return(null==(e=p.ingredient_name)?void 0:e.trim())||(t.ingredient_name="Ingredient name is required"),(!p.pack_price||p.pack_price<=0)&&(t.pack_price="Pack price must be greater than 0"),(!p.pack_size||0>=parseFloat(p.pack_size))&&(t.pack_size="Pack size must be greater than 0"),p.unit||(t.unit="Unit is required"),h(t),0===Object.keys(t).length})())try{await c(p)}catch(e){console.error("Error saving ingredient:",e)}};return(0,s.jsxs)("div",{className:"bg-[#1f1f1f] rounded-3xl p-6 border border-[#2a2a2a]",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:t?"Edit Ingredient":"Add New Ingredient"}),(0,s.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ingredient Name *"}),(0,s.jsx)("input",{type:"text",value:p.ingredient_name||"",onChange:e=>f("ingredient_name",e.target.value),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Tomatoes",required:!0}),g.ingredient_name&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:g.ingredient_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Brand"}),(0,s.jsx)("input",{type:"text",value:p.brand||"",onChange:e=>f("brand",e.target.value),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Coles"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pack Size *"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:p.pack_size||"",onChange:e=>f("pack_size",e.target.value),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 5",required:!0}),g.pack_size&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:g.pack_size})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pack Size Unit"}),(0,s.jsx)("select",{value:p.pack_size_unit||"GM",onChange:e=>f("pack_size_unit",e.target.value),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",children:r.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pack Price *"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:p.pack_price||"",onChange:e=>f("pack_price",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 12.50",required:!0}),g.pack_price&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:g.pack_price})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Cost Per Unit *"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:p.cost_per_unit||"",onChange:e=>f("cost_per_unit",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"Auto-calculated",required:!0}),g.cost_per_unit&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:g.cost_per_unit})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Unit *"}),(0,s.jsx)("select",{value:p.unit||"GM",onChange:e=>f("unit",e.target.value),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",required:!0,children:r.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),g.unit&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:g.unit})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Supplier"}),(0,s.jsx)("input",{type:"text",value:p.supplier||"",onChange:e=>f("supplier",e.target.value),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Coles"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Storage Location"}),(0,s.jsx)("input",{type:"text",value:p.storage_location||"",onChange:e=>f("storage_location",e.target.value),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., Coolroom"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Trim/Peel Waste (%)"}),(0,s.jsx)("input",{type:"number",step:"0.1",min:"0",max:"100",value:p.trim_peel_waste_percentage||0,onChange:e=>f("trim_peel_waste_percentage",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 10"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Yield (%)"}),(0,s.jsx)("input",{type:"number",step:"0.1",min:"0",max:"100",value:p.yield_percentage||100,onChange:e=>f("yield_percentage",parseFloat(e.target.value)||100),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 90"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Stock Level"}),(0,s.jsx)("input",{type:"number",step:"0.01",min:"0",value:p.min_stock_level||0,onChange:e=>f("min_stock_level",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 5"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Stock"}),(0,s.jsx)("input",{type:"number",step:"0.01",min:"0",value:p.current_stock||0,onChange:e=>f("current_stock",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 bg-[#2a2a2a] border border-[#2a2a2a] rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent",placeholder:"e.g., 10"})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-6",children:[(0,s.jsx)("button",{type:"submit",disabled:u,className:"flex-1 bg-gradient-to-r from-[#29E7CD] to-[#3B82F6] text-white px-6 py-3 rounded-2xl font-semibold hover:shadow-lg hover:shadow-[#29E7CD]/25 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Saving...":t?"Update Ingredient":"Add Ingredient"}),(0,s.jsx)("button",{type:"button",onClick:d,className:"flex-1 bg-[#2a2a2a] text-white px-6 py-3 rounded-2xl font-semibold hover:bg-[#3a3a3a] transition-all duration-300",children:"Cancel"})]})]})]})}function m(e){let{isOpen:t,onClose:a,onImport:r,loading:c=!1}=e,{t:o}=(0,l.Bd)(),[d,u]=(0,n.useState)(""),[x,p]=(0,n.useState)([]),[m,g]=(0,n.useState)(new Set),[h,b]=(0,n.useState)(null),f=e=>{e?g(new Set(x.map((e,t)=>t.toString()))):g(new Set)},j=async()=>{try{let e=x.filter((e,t)=>m.has(t.toString())).map(e=>({...e,ingredient_name:(0,i._J)(e.ingredient_name||""),brand:(0,i.SC)(e.brand||""),supplier:(0,i.zl)(e.supplier||""),storage_location:(0,i.M$)(e.storage_location||"")}));await r(e),u(""),p([]),g(new Set),b(null)}catch(e){console.error("Failed to import ingredients:",e)}},_=()=>{u(""),p([]),g(new Set),b(null),a()};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-[#1f1f1f] rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("div",{className:"p-6 border-b border-[#2a2a2a]",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:"\uD83D\uDCC1 Import Ingredients from CSV"}),(0,s.jsx)("button",{onClick:_,className:"p-2 rounded-full bg-[#2a2a2a] hover:bg-[#3a3a3a] text-gray-400 hover:text-white transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Upload CSV File"}),(0,s.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;let s=new FileReader;s.onload=e=>{var t;let a=null==(t=e.target)?void 0:t.result;u(a),(e=>{try{let t=e.split("\n").filter(e=>e.trim());if(t.length<2)return void b("CSV must have at least a header row and one data row");let a=t[0].split(",").map(e=>e.trim().toLowerCase()),s=[];for(let e=1;e<t.length;e++){let r=t[e].split(",").map(e=>e.trim()),n={};a.forEach((e,t)=>{let a=r[t]||"";e.includes("name")||e.includes("ingredient")?n.ingredient_name=(0,i._J)(a):e.includes("brand")?n.brand=(0,i.SC)(a):e.includes("cost")||e.includes("price")?n.cost_per_unit=parseFloat(a)||0:e.includes("unit")?n.unit=a.toUpperCase():e.includes("supplier")?n.supplier=(0,i.zl)(a):e.includes("code")||e.includes("sku")?n.product_code=a:e.includes("location")||e.includes("storage")?n.storage_location=(0,i.M$)(a):(e.includes("pack")||e.includes("size"))&&(n.pack_size=a||"1")}),n.ingredient_name&&(n.cost_per_unit||(n.cost_per_unit=0),n.cost_per_unit_as_purchased||(n.cost_per_unit_as_purchased=n.cost_per_unit||0),n.cost_per_unit_incl_trim||(n.cost_per_unit_incl_trim=n.cost_per_unit||0),n.trim_peel_waste_percentage||(n.trim_peel_waste_percentage=0),n.yield_percentage||(n.yield_percentage=100),n.unit||(n.unit="GM"),n.pack_size||(n.pack_size="1"),s.push(n))}p(s),b(null)}catch(e){b("Failed to parse CSV file")}})(a)},s.readAsText(a)},className:"w-full px-3 py-2 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-[#29E7CD]"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Supported columns: name, brand, cost, unit, supplier, code, location, pack_size"})]}),h&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg",children:h}),x.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-white",children:["Preview (",x.length," ingredients found)"]}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsx)("button",{onClick:()=>f(!0),className:"text-sm text-[#29E7CD] hover:text-[#29E7CD]/80 transition-colors",children:"Select All"}),(0,s.jsx)("button",{onClick:()=>f(!1),className:"text-sm text-gray-400 hover:text-white transition-colors",children:"Clear All"})]})]}),(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto border border-[#2a2a2a] rounded-lg",children:x.map((e,t)=>{let a=(e=>{let t=e.cost_per_unit||0,a=e.unit||"",s=t<1?t.toFixed(3):t.toFixed(2),r="";return e.pack_price&&e.pack_size&&e.pack_size_unit&&(r="Pack: $".concat(e.pack_price," for ").concat(e.pack_size).concat(e.pack_size_unit)),{cost:t,unit:a,formattedCost:s,packInfo:r}})(e),r=m.has(t.toString());return(0,s.jsx)("div",{className:"p-3 border-b border-[#2a2a2a] last:border-b-0 transition-colors ".concat(r?"bg-[#29E7CD]/10":"hover:bg-[#2a2a2a]/20"),children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:r,onChange:e=>((e,t)=>{let a=new Set(m);t?a.add(e):a.delete(e),g(a)})(t.toString(),e.target.checked),className:"w-4 h-4 text-[#29E7CD] bg-[#2a2a2a] border-[#2a2a2a] rounded focus:ring-[#29E7CD] focus:ring-2"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-white font-medium",children:e.ingredient_name}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:[e.brand&&"Brand: ".concat(e.brand," • "),"Cost: $",a.formattedCost,"/",a.unit,a.packInfo&&" • ".concat(a.packInfo)]})]})]})},t)})}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:_,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:j,disabled:c||0===m.size,className:"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white px-4 py-2 rounded-lg hover:from-[#29E7CD]/80 hover:to-[#D925C7]/80 transition-all duration-200 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Importing...":"Import Selected (".concat(m.size,")")})]})]}),(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-4 rounded-lg border border-[#2a2a2a]/50",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-white mb-2",children:"\uD83D\uDCCB CSV Format Instructions"}),(0,s.jsxs)("div",{className:"text-xs text-gray-400 space-y-1",children:[(0,s.jsx)("p",{children:"• First row should contain column headers"}),(0,s.jsx)("p",{children:"• Required columns: name (or ingredient), cost (or price), unit"}),(0,s.jsx)("p",{children:"• Optional columns: brand, supplier, code (or sku), location (or storage), pack_size"}),(0,s.jsx)("p",{children:"• Values will be automatically formatted and capitalized"}),(0,s.jsx)("p",{children:"• Empty rows will be skipped"})]})]})]})]})}):null}function g(e){let{formData:t,availableUnits:a,errors:r,onInputChange:n,formatCost:i}=e;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"\uD83D\uDCE6 Basic Information"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Let's start with the essential details"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ingredient Name *"}),(0,s.jsx)("input",{type:"text",required:!0,value:t.ingredient_name||"",onChange:e=>n("ingredient_name",e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., Fresh Tomatoes"}),r.ingredient_name&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:r.ingredient_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Brand (Optional)"}),(0,s.jsx)("input",{type:"text",value:t.brand||"",onChange:e=>n("brand",e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., Coles, Woolworths"})]})]}),(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83D\uDCE6 Packaging Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pack Size *"}),(0,s.jsx)("input",{type:"text",required:!0,value:t.pack_size||"",onChange:e=>n("pack_size",e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., 5"}),r.pack_size&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:r.pack_size})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pack Unit *"}),(0,s.jsxs)("select",{required:!0,value:t.pack_size_unit||"",onChange:e=>n("pack_size_unit",e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",children:[(0,s.jsx)("option",{value:"",children:"Select unit"}),a.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),r.pack_size_unit&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:r.pack_size_unit})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pack Price *"}),(0,s.jsx)("input",{type:"number",step:"0.01",required:!0,value:t.pack_price||"",onChange:e=>n("pack_price",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., 12.99"}),r.pack_price&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:r.pack_price})]})]})]}),(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83E\uDDEE Cost Calculation"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Working Unit *"}),(0,s.jsxs)("select",{required:!0,value:t.unit||"",onChange:e=>n("unit",e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",children:[(0,s.jsx)("option",{value:"",children:"Select unit"}),a.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),r.unit&&(0,s.jsx)("p",{className:"text-red-400 text-sm mt-1",children:r.unit})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Cost per Unit"}),(0,s.jsxs)("div",{className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl",children:["$",t.cost_per_unit?i(t.cost_per_unit):"0.000"]}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Automatically calculated from pack price and size"})]})]})]})]})}function h(e){let{formData:t,suppliers:a,errors:r,onInputChange:i,onWastagePercentageChange:l,onYieldPercentageChange:c,onAddSupplier:o}=e,[d,u]=(0,n.useState)(""),[x,p]=(0,n.useState)(!1),m=async e=>{if(e.trim())try{await o(e),u(""),p(!1)}catch(e){console.error("Failed to add supplier:",e)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"⚙️ Advanced Settings"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Configure supplier, storage, and yield information"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83C\uDFE2 Supplier Information"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Supplier"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("select",{value:t.supplier||"",onChange:e=>i("supplier",e.target.value),className:"flex-1 px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",children:[(0,s.jsx)("option",{value:"",children:"Select supplier"}),a.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,s.jsx)("button",{type:"button",onClick:()=>p(!0),className:"px-4 py-3 bg-[#29E7CD] text-black rounded-2xl hover:bg-[#29E7CD]/80 transition-all font-medium",children:"➕"})]})]}),x&&(0,s.jsx)("div",{className:"bg-[#1f1f1f] p-4 rounded-xl border border-[#29E7CD]/30",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"New supplier name",className:"flex-1 px-3 py-2 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all"}),(0,s.jsx)("button",{type:"button",onClick:()=>m(d),className:"px-3 py-2 bg-[#29E7CD] text-black rounded-lg hover:bg-[#29E7CD]/80 transition-all font-medium",children:"Add"}),(0,s.jsx)("button",{type:"button",onClick:()=>{p(!1),u("")},className:"px-3 py-2 bg-[#2a2a2a] text-white rounded-lg hover:bg-[#3a3a3a] transition-all",children:"Cancel"})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Code (Optional)"}),(0,s.jsx)("input",{type:"text",value:t.product_code||"",onChange:e=>i("product_code",e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., SKU123456"})]})]})]}),(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83D\uDCE6 Storage & Stock"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Storage Location"}),(0,s.jsx)("input",{type:"text",value:t.storage_location||"",onChange:e=>i("storage_location",e.target.value),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., Walk-in Cooler, Pantry"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Stock Level"}),(0,s.jsx)("input",{type:"number",value:t.min_stock_level||"",onChange:e=>i("min_stock_level",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., 10"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Stock"}),(0,s.jsx)("input",{type:"number",value:t.current_stock||"",onChange:e=>i("current_stock",parseFloat(e.target.value)||0),className:"w-full px-4 py-3 border border-[#2a2a2a] bg-[#0a0a0a] text-white rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#29E7CD] transition-all",placeholder:"e.g., 25"})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83C\uDFAF Yield & Wastage"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Wastage Percentage"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("input",{type:"range",min:"0",max:"100",value:t.trim_peel_waste_percentage||0,onChange:e=>l(parseInt(e.target.value)),className:"flex-1 h-2 bg-[#2a2a2a] rounded-lg appearance-none cursor-pointer slider"}),(0,s.jsxs)("div",{className:"w-20 text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-[#29E7CD]",children:[t.trim_peel_waste_percentage||0,"%"]}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:"Waste"})]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"How much gets thrown away during prep (peels, trimmings, etc.)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Yield Percentage"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("input",{type:"range",min:"0",max:"100",value:t.yield_percentage||100,onChange:e=>c(parseInt(e.target.value)),className:"flex-1 h-2 bg-[#2a2a2a] rounded-lg appearance-none cursor-pointer slider"}),(0,s.jsxs)("div",{className:"w-20 text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-[#29E7CD]",children:[t.yield_percentage||100,"%"]}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:"Yield"})]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"How much you get after prep (usable portion)"})]})]}),(0,s.jsx)("div",{className:"mt-4 p-4 bg-[#1f1f1f] rounded-xl border border-[#29E7CD]/20",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,s.jsx)("span",{className:"text-[#29E7CD]",children:"\uD83D\uDCA1"}),(0,s.jsxs)("span",{className:"text-gray-300",children:[(0,s.jsx)("strong",{children:"Tip:"})," These percentages are linked - adjusting one automatically adjusts the other. For example, if you waste 20%, you get 80% yield."]})]})})]})]})}function b(e){let{formData:t,formatCost:a}=e;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"✅ Review & Save"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Review your ingredient details before saving"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83D\uDCE6 Basic Information"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Name:"}),(0,s.jsx)("span",{className:"text-white font-medium",children:t.ingredient_name||"Not set"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Brand:"}),(0,s.jsx)("span",{className:"text-white",children:t.brand||"Not specified"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Pack Size:"}),(0,s.jsxs)("span",{className:"text-white",children:[t.pack_size||"Not set"," ",t.pack_size_unit||""]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Pack Price:"}),(0,s.jsxs)("span",{className:"text-white",children:["$",t.pack_price||"0.00"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Working Unit:"}),(0,s.jsx)("span",{className:"text-white",children:t.unit||"Not set"})]}),(0,s.jsxs)("div",{className:"flex justify-between border-t border-[#2a2a2a] pt-3",children:[(0,s.jsx)("span",{className:"text-[#29E7CD] font-medium",children:"Cost per Unit:"}),(0,s.jsxs)("span",{className:"text-[#29E7CD] font-bold",children:["$",t.cost_per_unit?a(t.cost_per_unit):"0.000"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83C\uDFE2 Supplier & Storage"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Supplier:"}),(0,s.jsx)("span",{className:"text-white",children:t.supplier||"Not specified"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Product Code:"}),(0,s.jsx)("span",{className:"text-white",children:t.product_code||"Not set"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Storage Location:"}),(0,s.jsx)("span",{className:"text-white",children:t.storage_location||"Not specified"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Min Stock:"}),(0,s.jsxs)("span",{className:"text-white",children:[t.min_stock_level||"0"," ",t.unit||""]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Current Stock:"}),(0,s.jsxs)("span",{className:"text-white",children:[t.current_stock||"0"," ",t.unit||""]})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-[#2a2a2a]/30 p-6 rounded-2xl border border-[#2a2a2a]/50",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"\uD83C\uDFAF Yield & Cost Analysis"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold text-[#D925C7] mb-2",children:[t.trim_peel_waste_percentage||0,"%"]}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Wastage"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Lost during prep"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold text-[#29E7CD] mb-2",children:[t.yield_percentage||100,"%"]}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Yield"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Usable portion"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold text-[#3B82F6] mb-2",children:["$",t.cost_per_unit_incl_trim?a(t.cost_per_unit_incl_trim):"0.000"]}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Adjusted Cost"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Including waste"})]})]}),(0,s.jsx)("div",{className:"mt-4 p-4 bg-[#1f1f1f] rounded-xl border border-[#29E7CD]/20",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("span",{className:"text-[#29E7CD] text-lg",children:"\uD83D\uDCA1"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-white font-medium mb-1",children:"Cost Impact"}),(0,s.jsxs)("p",{className:"text-gray-300 text-sm",children:["Your actual cost per unit is ",(0,s.jsxs)("strong",{children:["$",t.cost_per_unit_incl_trim?a(t.cost_per_unit_incl_trim):"0.000"]}),"after accounting for ",t.trim_peel_waste_percentage||0,"% wastage. This is the cost you should use for COGS calculations."]})]})]})})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-[#29E7CD]/10 to-[#D925C7]/10 border border-[#29E7CD]/30 rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,s.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF89"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Ready to Add Ingredient!"})]}),(0,s.jsxs)("p",{className:"text-gray-300 text-sm",children:["Your ingredient ",(0,s.jsx)("strong",{children:t.ingredient_name})," is ready to be added to your inventory. All calculations are complete and the ingredient will be available for use in recipes and COGS calculations."]})]})]})}function f(e){let{currentStep:t,totalSteps:a,onNext:r,onPrevious:n,onSave:i,onCancel:l,canProceed:c,loading:o=!1}=e,d=t===a;return(0,s.jsxs)("div",{className:"flex justify-between items-center pt-6 border-t border-[#2a2a2a]",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[1!==t&&(0,s.jsx)("button",{type:"button",onClick:n,disabled:o,className:"px-6 py-3 bg-[#2a2a2a] text-white rounded-2xl hover:bg-[#3a3a3a] transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"← Previous"}),(0,s.jsx)("button",{type:"button",onClick:l,disabled:o,className:"px-6 py-3 bg-red-600/20 text-red-400 rounded-2xl hover:bg-red-600/30 transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[!d&&(0,s.jsx)("button",{type:"button",onClick:r,disabled:!c||o,className:"px-8 py-3 rounded-2xl font-medium transition-all duration-200 ".concat(c&&!o?"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white hover:from-[#29E7CD]/80 hover:to-[#D925C7]/80 shadow-lg hover:shadow-xl":"bg-[#2a2a2a] text-gray-400 cursor-not-allowed"),children:o?(0,s.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"}),(0,s.jsx)("span",{children:"Loading..."})]}):(0,s.jsx)(s.Fragment,{children:"Next →"})}),d&&(0,s.jsx)("button",{type:"button",onClick:i,disabled:!c||o,className:"px-8 py-3 rounded-2xl font-medium transition-all duration-200 ".concat(c&&!o?"bg-gradient-to-r from-[#29E7CD] to-[#3B82F6] text-white hover:from-[#29E7CD]/80 hover:to-[#3B82F6]/80 shadow-lg hover:shadow-xl":"bg-[#2a2a2a] text-gray-400 cursor-not-allowed"),children:o?(0,s.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,s.jsx)("span",{children:"Saving..."})]}):(0,s.jsx)(s.Fragment,{children:"✅ Save Ingredient"})})]})]})}function j(e){let{suppliers:t,availableUnits:a,onSave:r,onCancel:c,onAddSupplier:d,loading:u=!1}=e,{t:x}=(0,l.Bd)(),[p,m]=(0,n.useState)(1),[j,_]=(0,n.useState)({ingredient_name:"",brand:"",pack_size:"",pack_size_unit:"",pack_price:0,unit:"",cost_per_unit:0,cost_per_unit_as_purchased:0,cost_per_unit_incl_trim:0,trim_peel_waste_percentage:0,yield_percentage:100,supplier:"",product_code:"",storage_location:"",min_stock_level:0,current_stock:0}),[v,y]=(0,n.useState)({}),N=()=>{if(j.pack_price&&j.pack_size&&j.pack_size_unit&&j.unit){var e,t,a,s;let r=(e=j.pack_price,t=parseFloat(j.pack_size),a=j.pack_size_unit,s=j.unit,0===e||0===t?0:e/(t*(0,o.oU)(1,a,s).conversionFactor));_(e=>({...e,cost_per_unit:r,cost_per_unit_as_purchased:r,cost_per_unit_incl_trim:r/((e.yield_percentage||100)/100)}))}},w=e=>{let t={};if(1===e){var a,s;(null==(a=j.ingredient_name)?void 0:a.trim())||(t.ingredient_name="Ingredient name is required"),(null==(s=j.pack_size)?void 0:s.trim())||(t.pack_size="Pack size is required"),j.pack_size_unit||(t.pack_size_unit="Pack unit is required"),(!j.pack_price||j.pack_price<=0)&&(t.pack_price="Pack price must be greater than 0"),j.unit||(t.unit="Working unit is required")}return y(t),0===Object.keys(t).length},k=async()=>{if(w(3))try{let e={...j,ingredient_name:(0,i._J)(j.ingredient_name||""),brand:j.brand?(0,i._J)(j.brand):void 0,supplier:j.supplier?(0,i._J)(j.supplier):void 0,storage_location:j.storage_location?(0,i._J)(j.storage_location):void 0};await r(e),m(1),_({ingredient_name:"",brand:"",pack_size:"",pack_size_unit:"",pack_price:0,unit:"",cost_per_unit:0,cost_per_unit_as_purchased:0,cost_per_unit_incl_trim:0,trim_peel_waste_percentage:0,yield_percentage:100,supplier:"",product_code:"",storage_location:"",min_stock_level:0,current_stock:0}),y({})}catch(e){console.error("Error saving ingredient:",e)}},C=3===p?w(3):w(p),D={formData:j,suppliers:t,availableUnits:a,errors:v,onInputChange:(e,t)=>{if(_(a=>({...a,[e]:t})),v[e]&&y(t=>({...t,[e]:""})),["pack_price","pack_size","pack_size_unit","unit"].includes(e)&&setTimeout(N,100),"ingredient_name"===e&&"string"==typeof t&&t.length>3){let e=(e=>{let t=e.toLowerCase();return t.includes("onion")||t.includes("garlic")||t.includes("celery")||t.includes("carrot")||t.includes("leek")||t.includes("fennel")?35:t.includes("tomato")||t.includes("cucumber")||t.includes("bell pepper")||t.includes("capsicum")||t.includes("eggplant")||t.includes("zucchini")?20:t.includes("potato")||t.includes("apple")||t.includes("banana")||t.includes("orange")||t.includes("lemon")||t.includes("lime")?10:t.includes("rice")||t.includes("pasta")||t.includes("flour")||t.includes("sugar")||t.includes("salt")||t.includes("oil")?2:15})(t);_(t=>({...t,trim_peel_waste_percentage:e,yield_percentage:100-e,cost_per_unit_incl_trim:(t.cost_per_unit||0)/((100-e)/100)}))}},onWastagePercentageChange:e=>{let t=Math.max(0,Math.min(100,Math.round(e))),a=100-t;_(e=>({...e,trim_peel_waste_percentage:t,yield_percentage:a,cost_per_unit_incl_trim:(e.cost_per_unit||0)/(a/100)}))},onYieldPercentageChange:e=>{let t=Math.max(0,Math.min(100,Math.round(e))),a=100-t;_(e=>({...e,yield_percentage:t,trim_peel_waste_percentage:a,cost_per_unit_incl_trim:(e.cost_per_unit||0)/(t/100)}))},onAddSupplier:d,formatCost:e=>e<1?e.toFixed(3):e.toFixed(2)};return(0,s.jsxs)("div",{className:"bg-[#1f1f1f] p-6 rounded-3xl shadow-lg border border-[#2a2a2a] mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-white",children:"\uD83E\uDD58 Add New Ingredient"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-[#29E7CD] rounded-full"}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"Guided Setup"})]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("div",{className:"flex items-center justify-center space-x-4",children:[1,2,3].map(e=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold transition-all duration-200 ".concat(e<=p?"bg-gradient-to-r from-[#29E7CD] to-[#D925C7] text-white":"bg-[#2a2a2a] text-gray-400"),children:e}),e<3&&(0,s.jsx)("div",{className:"w-12 h-1 mx-2 transition-all duration-200 ".concat(e<p?"bg-gradient-to-r from-[#29E7CD] to-[#D925C7]":"bg-[#2a2a2a]")})]},e))}),(0,s.jsx)("div",{className:"flex justify-center mt-4",children:(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:[1===p&&"\uD83D\uDCE6 Basic Information",2===p&&"⚙️ Advanced Settings",3===p&&"✅ Review & Save"]})})]}),1===p&&(0,s.jsx)(g,{...D}),2===p&&(0,s.jsx)(h,{...D}),3===p&&(0,s.jsx)(b,{...D}),(0,s.jsx)(f,{currentStep:p,totalSteps:3,onNext:()=>{w(p)&&m(e=>Math.min(e+1,3))},onPrevious:()=>{m(e=>Math.max(e-1,1))},onSave:k,onCancel:c,canProceed:C,loading:u})]})}function _(){let{t:e}=(0,l.Bd)(),[t,a]=(0,n.useState)([]),[o,g]=(0,n.useState)([]),[h,b]=(0,n.useState)([]),[f,_]=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,[a,s]=(0,n.useState)(e),[r,i]=(0,n.useState)(!0),l=(0,n.useRef)(null),c=(0,n.useRef)(Date.now());return(0,n.useEffect)(()=>(i(!0),c.current=Date.now(),()=>{i(!1),l.current&&clearTimeout(l.current)}),[]),[a,e=>{if(r)if(e){let e=Date.now()-c.current;e>=t?s(!0):l.current=setTimeout(()=>{r&&s(!0)},t-e)}else l.current&&(clearTimeout(l.current),l.current=null),s(!1)}]}(!1,200),[v,y]=(0,n.useState)(null),[N,w]=(0,n.useState)(!1),[k,C]=(0,n.useState)(null),[D,S]=(0,n.useState)(!1),[E,z]=(0,n.useState)(""),[F,A]=(0,n.useState)([]),[I,P]=(0,n.useState)(!1),[L,B]=(0,n.useState)(new Set),[U,M]=(0,n.useState)("g"),[q,T]=(0,n.useState)(""),[W,O]=(0,n.useState)(""),[V,R]=(0,n.useState)(""),[$,G]=(0,n.useState)("name"),[H,J]=(0,n.useState)(1),[Y,K]=(0,n.useState)({ingredient_name:"",brand:"",pack_size:"",pack_size_unit:"g",pack_price:0,unit:"g",cost_per_unit:0,supplier:"",product_code:"",storage_location:"",min_stock_level:0,current_stock:0});(0,n.useMemo)(()=>{let e=t.filter(e=>{let t=!q||e.ingredient_name.toLowerCase().includes(q.toLowerCase())||e.brand&&e.brand.toLowerCase().includes(q.toLowerCase())||e.supplier&&e.supplier.toLowerCase().includes(q.toLowerCase()),a=!W||e.supplier===W,s=!V||e.storage_location===V;return t&&a&&s});e.sort((e,t)=>{switch($){case"name":return e.ingredient_name.localeCompare(t.ingredient_name);case"cost_asc":return(e.cost_per_unit||0)-(t.cost_per_unit||0);case"cost_desc":return(t.cost_per_unit||0)-(e.cost_per_unit||0);case"supplier":return(e.supplier||"").localeCompare(t.supplier||"");default:return 0}}),g(e)},[t,q,W,V,$]);let Q=async()=>{_(!0);try{let{data:e,error:t}=await r.ND.from("ingredients").select("*").order("ingredient_name");if(t)throw t;a(e||[])}catch(e){y("Failed to fetch ingredients")}finally{_(!1)}},X=async()=>{try{let{data:e,error:t}=await r.ND.from("suppliers").select("*").order("name");if(t)throw t;b(e||[])}catch(e){}};(0,n.useEffect)(()=>{Q(),X()},[]);let Z=async e=>{try{let{data:t,error:s}=await r.ND.from("ingredients").insert([{...e,ingredient_name:(0,i._J)(e.ingredient_name||""),brand:e.brand?(0,i.SC)(e.brand):null,supplier:e.supplier?(0,i.zl)(e.supplier):null,storage_location:e.storage_location?(0,i.M$)(e.storage_location):null,product_code:e.product_code?(0,i.$m)(e.product_code):null}]).select();if(s)throw s;a(e=>[...e,...t||[]]),w(!1),J(1),K({ingredient_name:"",brand:"",pack_size:"",pack_size_unit:"g",pack_price:0,unit:"g",cost_per_unit:0,supplier:"",product_code:"",storage_location:"",min_stock_level:0,current_stock:0})}catch(e){y("Failed to add ingredient")}},ee=async e=>{try{let{error:t}=await r.ND.from("ingredients").delete().eq("id",e);if(t)throw t;a(t=>t.filter(t=>t.id!==e))}catch(e){y("Failed to delete ingredient")}},et=async()=>{try{let{error:e}=await r.ND.from("ingredients").delete().in("id",Array.from(L));if(e)throw e;a(e=>e.filter(e=>!L.has(e.id))),B(new Set)}catch(e){y("Failed to delete selected ingredients")}},ea=async()=>{try{P(!0);let{data:e,error:t}=await r.ND.from("ingredients").insert(F.map(e=>({...e,ingredient_name:(0,i._J)(e.ingredient_name||""),brand:e.brand?(0,i.SC)(e.brand):null,supplier:e.supplier?(0,i.zl)(e.supplier):null,storage_location:e.storage_location?(0,i.M$)(e.storage_location):null,product_code:e.product_code?(0,i.$m)(e.product_code):null}))).select();if(t)throw t;a(t=>[...t,...e||[]]),S(!1),z(""),A([])}catch(e){y("Failed to import ingredients")}finally{P(!1)}};return f?(0,s.jsx)(c.JQ,{}):(0,s.jsx)("div",{className:"min-h-screen bg-[#0a0a0a] p-4 sm:p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-white mb-2",children:["\uD83E\uDD58 ",e("ingredients.title","Ingredients Management")]}),(0,s.jsx)("p",{className:"text-gray-400",children:e("ingredients.subtitle","Manage your kitchen ingredients and inventory")})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Display costs in:"}),(0,s.jsxs)("select",{value:U,onChange:e=>M(e.target.value),className:"px-4 py-3 bg-[#0a0a0a] border border-[#2a2a2a] rounded-lg text-white focus:ring-2 focus:ring-[#29E7CD] focus:border-transparent min-h-[44px] flex items-center justify-center",children:[(0,s.jsxs)("optgroup",{label:"Weight",children:[(0,s.jsx)("option",{value:"g",children:"Grams (g)"}),(0,s.jsx)("option",{value:"kg",children:"Kilograms (kg)"}),(0,s.jsx)("option",{value:"oz",children:"Ounces (oz)"}),(0,s.jsx)("option",{value:"lb",children:"Pounds (lb)"})]}),(0,s.jsxs)("optgroup",{label:"Volume",children:[(0,s.jsx)("option",{value:"ml",children:"Milliliters (ml)"}),(0,s.jsx)("option",{value:"l",children:"Liters (L)"}),(0,s.jsx)("option",{value:"tsp",children:"Teaspoons (tsp)"}),(0,s.jsx)("option",{value:"tbsp",children:"Tablespoons (tbsp)"}),(0,s.jsx)("option",{value:"cup",children:"Cups"})]})]})]})]})}),v&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-500 text-red-400 px-4 py-3 rounded-lg mb-6",children:v}),(0,s.jsx)(x,{selectedIngredients:L,filteredIngredients:o,onAddIngredient:()=>w(!0),onImportCSV:()=>S(!0),onExportCSV:()=>{let e=new Blob([["Ingredient Name,Brand,Pack Size,Pack Size Unit,Pack Price,Unit,Cost Per Unit,Supplier,Product Code,Storage Location,Min Stock Level,Current Stock",...o.map(e=>[e.ingredient_name,e.brand||"",e.pack_size||"",e.pack_size_unit||"",e.pack_price||0,e.unit||"",e.cost_per_unit||0,e.supplier||"",e.product_code||"",e.storage_location||"",e.min_stock_level||0,e.current_stock||0].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="ingredients.csv",a.click(),window.URL.revokeObjectURL(t)},onBulkDelete:et,onBulkUpdate:async()=>{},loading:f}),N&&(0,s.jsx)(j,{suppliers:h,availableUnits:["g","kg","oz","lb","ml","l","tsp","tbsp","cup","pc","box","pack","bag","bottle","can"],onSave:Z,onCancel:()=>{w(!1),J(1),K({ingredient_name:"",brand:"",pack_size:"",pack_size_unit:"g",pack_price:0,unit:"g",cost_per_unit:0,supplier:"",product_code:"",storage_location:"",min_stock_level:0,current_stock:0})},onAddSupplier:async e=>{console.log("Adding supplier:",e)},loading:f}),(0,s.jsx)(u,{ingredients:t,searchTerm:q,supplierFilter:W,storageFilter:V,sortBy:$,displayUnit:U,onSearchChange:T,onSupplierFilterChange:O,onStorageFilterChange:R,onSortChange:G,onDisplayUnitChange:M}),(0,s.jsx)(d,{ingredients:o,displayUnit:U,onEdit:C,onDelete:ee,selectedIngredients:L,onSelectIngredient:(e,t)=>{let a=new Set(L);t?a.add(e):a.delete(e),B(a)},onSelectAll:e=>{e?B(new Set(o.map(e=>e.id))):B(new Set)},loading:f}),k&&(0,s.jsx)(p,{ingredient:k,suppliers:h,availableUnits:["g","kg","oz","lb","ml","l","tsp","tbsp","cup","pc","box","pack","bag","bottle","can"],onSave:async e=>{if(null==k?void 0:k.id)try{let{data:t,error:s}=await r.ND.from("ingredients").update({...e,updated_at:new Date().toISOString()}).eq("id",k.id).select().single();if(s)throw s;a(e=>e.map(e=>e.id===k.id?t:e)),C(null)}catch(e){console.error("Error updating ingredient:",e),y("Failed to update ingredient")}},onCancel:()=>C(null),loading:f}),D&&(0,s.jsx)(m,{isOpen:D,onClose:()=>{S(!1),z(""),A([])},onImport:ea,loading:I})]})})}},82114:(e,t,a)=>{Promise.resolve().then(a.bind(a,23454))}},e=>{e.O(0,[8888,1459,563,8650,8405,9420,622,7979,1899,4450,9324,8585,9592,433,2652,3494,2574,9173,3023,1356,309,4191,2834,957,6691,1151,9473,9219,6053,3376,2076,7358],()=>e(e.s=82114)),_N_E=e.O()}]);